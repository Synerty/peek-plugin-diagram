webpackJsonp([1],{"++1W":function(t,e,n){"use strict";var o=n("qbdv"),r=n("/oeL"),i=n("kzAo"),s=n("uI+l"),c=(n.n(s),n("tRBE")),a=n("DBLw"),u=n("cbTp"),l=n("FF/L"),f=n("D4RW"),p=n("HsD/"),d=n("84OX"),h=n("6Jsr"),y=n("sZSy"),v=n("HzwN"),_=n("2qPZ");n.d(e,"a",function(){return b});var g=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},b=function(){function t(){}return t}();b=g([n.i(r.b)({imports:[o.a].concat(i.a.FormsModules),exports:[f.a],providers:[y.a,c.a,u.a,l.a,a.a,{provide:v.a,useClass:h.a},p.a,d.a],declarations:[f.a,_.a]})],b)},"+8ml":function(t,e,n){"use strict";var o=n("yold"),r=n("Mf0i"),i=n("pibO"),s=n("0OQ5"),c=n("b2ma"),a=n("6ql+");n.d(e,"b",function(){return u}),n.d(e,"a",function(){return l});var u;!function(t){t[t.ellipse=0]="ellipse",t[t.polygon=1]="polygon",t[t.polyline=2]="polyline",t[t.text=3]="text",t[t.group=4]="group",t[t.groupPointer=5]="groupPointer"}(u||(u={}));var l=function(){function t(){}return t.type=function(e){return t.typeMap[e._tt][0]},t.wrapper=function(e){return t.typeMap[e._tt][1]},t}();l.typeMap={DT:[u.text,r.a],DPG:[u.polygon,i.a],DPL:[u.polyline,s.a],DE:[u.ellipse,o.a],DG:[u.group,a.a],DGP:[u.groupPointer,c.a]}},"+smj":function(t,e,n){"use strict";var o=n("S4Bb"),r=(n.n(o),n("99Qt")),i=n("5KeN");n.d(e,"a",function(){return s});var s=function(){function t(t,e,n,o){this.config=t,this.model=e,this.dispDelegate=n,this.lifecycleEventEmitter=o,this._delegate=null,this.canvas=null,this.mouseOffsetX=0,this.mouseOffsetY=0,this.delegateFinished()}return t.prototype.setDelegate=function(t){this._delegate&&this._delegate.shutdown(),this._delegate=new t(this,this.config,this.model,this.dispDelegate),this.config.mouse.currentDelegateName=this._delegate.NAME},t.prototype.delegateFinished=function(){this.setDelegate(i.a)},t.prototype._getMouse=function(t){var e=t.pageX,n=t.pageY;if(null==e)if(null!=t.changedTouches&&t.changedTouches.length>=0){var o=t.changedTouches[0];e=o.pageX,n=o.pageY}else console.log("ERROR: Failed to determine pan coordinates");var r=e-this.mouseOffsetX,i=n-this.mouseOffsetY,s=r,c=i,a=this.config.viewPort.zoom,u=this.config.viewPort.pan;return r=r/a+u.x,i=i/a+u.y,isNaN(r)&&console.log("mx IS NaN"),this.config.mouse.currentViewPortPosition={x:r,y:i},this.config.mouse.currentCanvasPosition={x:s,y:c},{x:r,y:i,clientX:s,clientY:c,time:new Date}},t.prototype.setCanvas=function(t){var e=this;this.canvas=t,t.addEventListener("keydown",function(t){e._delegate.keyDown(t)},!0),t.addEventListener("keypress",function(t){e._delegate.keyPress(t)},!0),t.addEventListener("keyup",function(t){e._delegate.keyUp(t)},!0),t.addEventListener("mousedown",function(t){t instanceof MouseEvent&&e._delegate.mouseDown(t,e._getMouse(t))},!0),t.addEventListener("mousemove",function(t){t instanceof MouseEvent&&e._delegate.mouseMove(t,e._getMouse(t))},!0),t.addEventListener("mouseup",function(t){t instanceof MouseEvent&&e._delegate.mouseUp(t,e._getMouse(t))},!0),t.addEventListener("mousewheel",function(t){if(t instanceof MouseEvent)return e._delegate.mouseWheel(t,e._getMouse(t)),t.preventDefault(),!1},!0),t.addEventListener("dblclick",function(t){t instanceof MouseEvent&&e._delegate.mouseDoubleClick(t,e._getMouse(t))},!0),t.addEventListener("selectstart",function(t){return t.preventDefault(),!1},!0),t.addEventListener("contextmenu",r.a,!0),t.addEventListener("touchstart",function(t){t instanceof TouchEvent&&(e._delegate.touchStart(t,e._getMouse(t)),n.i(r.a)(t))},!0),t.addEventListener("touchmove",function(t){t instanceof TouchEvent&&(e._delegate.touchMove(t,e._getMouse(t)),n.i(r.a)(t))},!0),t.addEventListener("touchend",function(t){t instanceof TouchEvent&&(e._delegate.touchEnd(t,e._getMouse(t)),n.i(r.a)(t))},!0),this.config.canvas.windowChange.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(){return e.updateCanvasSize()})},t.prototype.updateCanvasSize=function(){var t=o(this.canvas),e=this.canvas,n=t.width(),r=t.height(),i=parseInt(t.css("padding-left"))||0,s=parseInt(t.css("padding-top"))||0,c=parseInt(t.css("border-left-width"))||0,a=parseInt(t.css("border-top-width"))||0,u=document.body.parentNode,l=u.offsetTop,f=u.offsetLeft;if(this.mouseOffsetX=0,this.mouseOffsetY=0,null!=e.offsetParent)do{this.mouseOffsetX+=e.offsetLeft,this.mouseOffsetY+=e.offsetTop}while(e=e.offsetParent);this.mouseOffsetX+=i+c+f+n/2,this.mouseOffsetY+=s+a+l+r/2},t.prototype.draw=function(t){this._delegate&&this._delegate.draw(t)},t}()},0:function(t,e,n){t.exports=n("cDNt")},"0OQ5":function(t,e,n){"use strict";var o=n("wuWp");n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.lineColor=function(t){return t.lcl},e.lineStyle=function(t){return t.lsl},e.lineWidth=function(t){return t.w},e.geom=function(t){return t.g},e.startKey=function(t){return t.sk},e.endKey=function(t){return t.ek},e}(o.a)},"1c4N":function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"DispTextStyle",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"1djn":function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("fnfU"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e.prototype.gridSizeForZoom=function(t){if(null==t)throw new Error("Zoom can't be null");for(var e=0,n=this.gridSizes;e<n.length;e++){var o=n[e];if(o.min<=t&&t<o.max)return o}throw new Error("Unable to determine grid size for zoom "+t)},e.prototype.gridKeysForArea=function(t,e){function n(t){return parseInt(t)}for(var o=this.gridSizeForZoom(e),r=n(t.x/o.xGrid),i=n((t.x+t.w)/o.xGrid)+1,s=n(t.y/o.yGrid),c=n((t.y+t.h)/o.yGrid)+1,a=[],u=r;u<i;u++)for(var l=s;l<c;l++)a.push(this.id.toString()+"|"+o.key+"."+u+"x"+l);return a},e}(o.Tuple);a.tupleName=r.c+"ModelCoordSet",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"1wOJ":function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"DispColor",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"2pCw":function(t,e,n){"use strict";var o=n("cyHF");n.d(e,"a",function(){return r});var r=function(){function t(t,e){if(void 0===e&&(e=null),this.gridKey=null,this.lastUpdate=null,this.loadedFromServerDate=new Date,this.disps=[],"string"==typeof t)return void(this.gridKey=t);var r=t;n.i(o.a)(null!=e,"lookupStore can not be null"),this.gridKey=r.gridKey,this.lastUpdate=r.lastUpdate,this.loadedFromServerDate=new Date,this.disps=[];var i=[];if(null!=r.dispJsonStr&&0!=r.dispJsonStr.length)try{i=JSON.parse(r.dispJsonStr)}catch(t){console.error(t.toString())}for(var s=0;s<i.length;s++){var c=i[s];null!=c.id&&(null!=e.linkDispLookups(c)&&this.disps.push(c))}}return t.prototype.hasData=function(){return!(null==this.lastUpdate&&0==this.disps.length)},t}()},"2qPZ":function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("cbTp"));n.d(e,"a",function(){return u});var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(t){function e(e){var n=t.call(this)||this;return n.lookupCache=e,n}return s(e,t),e.prototype.ngOnInit=function(){},e}(r.ComponentLifecycleEventEmitter);u=c([n.i(o.f)({selector:"pl-diagram-layer",template:n("zSxQ")}),a("design:paramtypes",["function"==typeof(l=void 0!==i.a&&i.a)&&l||Object])],u);var l},"3mKK":function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"LocationIndexTuple",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"5KeN":function(t,e,n){"use strict";var o=n("99Qt"),r=n("iw1t"),i=(n.n(r),n("LjK0"));n.d(e,"a",function(){return c});var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(t){function e(n,o,r,i){var s=t.call(this,e.TOOL_NAME)||this;return s.canvasInput=n,s.config=o,s.model=r,s.dispDelegate=i,s.STATE_NONE=0,s.STATE_SELECTING=1,s.STATE_DRAG_SELECTING=2,s.STATE_MOVING_RENDERABLE=3,s.STATE_MOVING_HANDLE=4,s.STATE_CANVAS_PANNING=5,s.STATE_CANVAS_ZOOMING=6,s._state=0,s._passedDragThreshold=!1,s._mouseDownOnSelection=!1,s._mouseDownOnCoord=!1,s._mouseDownWithShift=!1,s._mouseDownWithCtrl=!1,s._mouseDownMiddleButton=!1,s._mouseDownRightButton=!1,s._mouseDownOnHandle=null,s._lastPinchDist=null,s._startMousePos=null,s._reset(),s}return s(e,t),e.prototype._reset=function(){this._state=this.STATE_NONE,this._passedDragThreshold=!1,this._mouseDownOnSelection=!1,this._mouseDownOnCoord=!1,this._mouseDownWithShift=!1,this._mouseDownWithCtrl=!1,this._mouseDownMiddleButton=!1,this._mouseDownRightButton=!1,this._mouseDownOnHandle=null,this._lastPinchDist=null,this._startMousePos=null,this._lastMousePos=null},e.prototype.keyUp=function(t){var e=this.config.mouse.phUpDownZoomFactor;if(46==t.keyCode);else if(33==t.keyCode){var n=this.config.viewPort.zoom;n*=1+e/100,this.config.updateViewPortZoom(n)}else if(34==t.keyCode){var n=this.config.viewPort.zoom;n*=1-e/100,this.config.updateViewPortZoom(n)}},e.prototype.touchStart=function(t,e){2==t.targetTouches.length?(this._state=this.STATE_CANVAS_ZOOMING,this._lastPinchDist=null):this.mouseDown(t,e)},e.prototype.mouseDown=function(t,e){if(this._mouseDownWithShift=t.shiftKey,this._mouseDownWithCtrl=t.ctrlKey,this._mouseDownMiddleButton=1==t.button,this._mouseDownRightButton=2==t.button,this._startMousePos=e,this._lastMousePos=e,this._mouseDownMiddleButton||this._mouseDownRightButton)return void(this._state=this.STATE_CANVAS_PANNING);for(var n=this.model.selectedDisps(),o=n.length-1;o>=0;o--)for(var r=n[o],i=this.dispDelegate.handles(r),s=0;s<i.length;s++){var c=i[s];if(c.contains(e.x,e.y)){this._mouseDownOnHandle={coord:r,handle:c,handleIndex:s};break}}for(var a=this.config.mouse.selecting.margin,o=n.length-1;o>=0;o--){var u=n[o];if(this.dispDelegate.contains(u,e.x,e.y,a)){this._mouseDownOnSelection=!0;break}}if(this._mouseDownOnSelection)this._mouseDownOnCoord=!0;else for(var l=this.model.selectableDisps(),o=l.length-1;o>=0;o--){var u=l[o];if(this.dispDelegate.contains(u,e.x,e.y,a)){this._mouseDownOnCoord=!0;break}}this._mouseDownOnCoord?this._state=this.STATE_SELECTING:(this._state=this.STATE_CANVAS_PANNING,this.model.clearSelection())},e.prototype.touchMove=function(t,e){this._state==this.STATE_CANVAS_ZOOMING?this._touchZoom(t,e):this.mouseMove(t,e),t.preventDefault()},e.prototype._touchZoom=function(t,e){var n=t.targetTouches[0].pageX,o=t.targetTouches[0].pageY,r=t.targetTouches[1].pageX,i=t.targetTouches[1].pageY,s={clientX:e.clientX,clientY:e.clientY};console.log(s);var c=Math.sqrt((n-r)*(n-r)+(o-i)*(o-i));if(null==this._lastPinchDist)return void(this._lastPinchDist=c);var a=this._lastPinchDist-c;this._lastPinchDist=c,this._zoomPan(s.clientX,s.clientY,a)},e.prototype._zoomPan=function(t,e,n){if(n){n*=-1;var o=this.config.viewPort.zoom,r=this.config.viewPort.pan,i={x:t/o+r.x,y:e/o+r.y};if(o*=1+n/100,this.config.viewPort.minZoom<o&&o<this.config.viewPort.maxZoom){var s={x:t/o+r.x,y:e/o+r.y},c={x:r.x+(i.x-s.x),y:r.y+(i.y-s.y)};this.config.updateViewPortPan(c),this.config.updateViewPortZoom(o)}}},e.prototype.mouseMove=function(t,e){if(this._state!=this.STATE_NONE){switch(this._passedDragThreshold=this._passedDragThreshold||this._hasPassedDragThreshold(this._startMousePos,e),this._state==this.STATE_SELECTING&&this._passedDragThreshold&&(this._mouseDownOnSelection?this._state=this.STATE_MOVING_RENDERABLE:this._mouseDownOnCoord?(this._changeSelection(this._selectByPoint(this._startMousePos)),this._state=this.STATE_MOVING_RENDERABLE):this._state=this.STATE_DRAG_SELECTING),this._state){case this.STATE_CANVAS_PANNING:var n=this._setLastMousePos(e),o=this.config.viewPort.pan,i={x:o.x-n.dClientX/this.config.viewPort.zoom,y:o.y-n.dClientY/this.config.viewPort.zoom};this.config.updateViewPortPan(i);break;case this.STATE_DRAG_SELECTING:this._lastMousePos=e;break;case this.STATE_MOVING_RENDERABLE:case this.STATE_MOVING_HANDLE:for(var s=this.model.selectedDisps(),n=this._setLastMousePos(e),c=s.length-1;c>=0;--c)this.dispDelegate.deltaMove(s[c],n.dx,n.dy);if(0!=s.length){this.config.invalidate();break}if(this._state==this.STATE_MOVING_HANDLE){var a=this._setLastMousePos(e),u=this._mouseDownOnHandle;r(null!=u,"selected handler is null"),u.coord.deltaMoveHandle(a.dx,a.dy,u.handle,u.handleIndex)}}this.config.invalidate()}},e.prototype.touchEnd=function(t,e){this.mouseUp(t,e)},e.prototype.mouseUp=function(t,e){switch(this._state){case this.STATE_SELECTING:case this.STATE_DRAG_SELECTING:var n=[];this._state==this.STATE_SELECTING?n=this._selectByPoint(this._startMousePos):this._state==this.STATE_DRAG_SELECTING?n=this._selectByBox(this._startMousePos,e):r(!1,"Invalid state"),this._changeSelection(n);break;case this.STATE_MOVING_RENDERABLE:case this.STATE_MOVING_HANDLE:for(var o=this.model.selectedDisps(),i=o.length-1;i>=0;i--)console.log("TODO, Store node move states");console.log("TODO, this.canvasInput._notifyOfChange")}this._reset(),this.config.invalidate()},e.prototype.mouseDoubleClick=function(t,e){var n=this._selectByTypeAndBounds(e);this.model.addSelection(n)},e.prototype.mouseWheel=function(t,e){var n=t.deltaY||t.wheelDelta;15<n&&(n=15),n<-15&&(n=-15),this._zoomPan(e.clientX,e.clientY,n)},e.prototype.draw=function(t){switch(this._state){case this.STATE_DRAG_SELECTING:var e=this.config.viewPort.zoom,n=this._startMousePos.x,o=this._startMousePos.y,r=this._lastMousePos.x-this._startMousePos.x,i=this._lastMousePos.y-this._startMousePos.y;t.strokeStyle=this.config.mouse.selecting.color,t.lineWidth=this.config.mouse.selecting.width/e,t.dashedRect(n,o,r,i,this.config.mouse.selecting.dashLen/e),t.stroke();break;case this.STATE_NONE:}},e.prototype._selectByPoint=function(t){var e=this,n=this.config.mouse.selecting.margin,o=this.model.selectableDisps(),r=o.filter(function(o){return e.dispDelegate.contains(o,t.x,t.y,n)},this);return r.sort(function(t,n){return e.dispDelegate.selectionPriotityCompare(t,n)}),!this._mouseDownWithCtrl&&r.length&&(r=[r[r.length-1]]),r},e.prototype._selectByBox=function(t,e){var n=this,o=this.model.selectableDisps(),r=i.a.fromGeom([t,e]);return o.filter(function(t){return n.dispDelegate.withIn(t,r.x,r.y,r.w,r.h)})},e.prototype._selectByTypeAndBounds=function(t){var e=this,n=this._selectByPoint(t);if(!n.length)return[];var o=n[n.length-1];return this.model.selectableDisps().filter(function(t){return e.dispDelegate.similarTo(t,o)})},e.prototype._changeSelection=function(t){this._mouseDownOnSelection&&this._mouseDownWithShift?this.model.removeSelection(t):(this._mouseDownWithShift||this.model.clearSelection(),this.model.addSelection(t))},e}(o.b)},"5ckv":function(t,e,n){"use strict";function o(){return new p.a([])}var r=n("fc+i"),i=n("/oeL"),s=n("IEMT"),c=n("++1W"),a=n("gCqq"),u=(n.n(a),n("yMcj")),l=(n.n(u),n("qhij")),f=n("OiVd"),p=n("iRZW"),d=n("NRFc"),h=n("tqqM"),y=n("PaR+");n.d(e,"a",function(){return _});var v=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},_=function(){function t(){}return t}();_=v([n.i(i.b)({declarations:[s.a],imports:[r.a,c.a],providers:[{provide:u.TupleStorageFactoryService,useClass:d.a},{provide:y.a,useClass:h.a},{provide:p.a,useFactory:o},{provide:f.a,useClass:l.a},a.Ng2BalloonMsgService,u.VortexStatusService,u.VortexService],bootstrap:[s.a]})],_)},"5wLy":function(t,e){t.exports='\n<pl-diagram-canvas *ngIf="modelSetKey != null" [modelSetKey]="modelSetKey"></pl-diagram-canvas>'},"6Jsr":function(t,e,n){"use strict";var o=n("/oeL"),r=n("HzwN"),i=n("Dqrr"),s=(n.n(i),n("84OX")),c=n("gCqq");n.n(c);n.d(e,"a",function(){return f});var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},l=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},f=function(t){function e(e,n){var o=t.call(this)||this;return o.locationIndexFactoryService=e,o.balloonMsg=n,o.titleUpdatedSubject=new i.Subject,o.positionByCoordSetSubject=new i.Subject,o.positionSubject=new i.Subject,o.positionByKeySubject=new i.Subject,o.isReadySubject=new i.Subject,o.postionUpdatedSubject=new i.Subject,o}return a(e,t),e.prototype.positionByCoordSet=function(t){this.positionByCoordSetSubject.next(t)},e.prototype.position=function(t,e,n,o){this.positionSubject.next({coordSetKey:t,x:e,y:n,zoom:o})},e.prototype.positionByKey=function(t,e,n){var o=this;this.locationIndexFactoryService.indexForModelSetKey(t).then(function(n){n.getLocations(e).then(function(n){0==n.length&&o.balloonMsg.showError("Can not locate disply item "+e+" in model set "+t);var r=n[0];o.positionSubject.next({coordSetKey:r.coordSetKey,x:r.x,y:r.y,zoom:2})})})},e.prototype.canPositionByKey=function(t,e){return this.locationIndexFactoryService.indexForModelSetKey(t).then(function(t){return t.getLocations(e).then(function(t){return 0!=t.length})})},e.prototype.setReady=function(t){this.isReadySubject.next(!0)},e.prototype.setTitle=function(t){this.titleUpdatedSubject.next(t)},e.prototype.positionUpdated=function(t){this.postionUpdatedSubject.next(t)},e.prototype.isReadyObservable=function(){return this.isReadySubject},e.prototype.positionUpdatedObservable=function(){return this.postionUpdatedSubject},e.prototype.titleUpdatedObservable=function(){return this.titleUpdatedSubject},e.prototype.positionObservable=function(){return this.positionSubject},e.prototype.positionByKeyObservable=function(){return this.positionByKeySubject},e.prototype.positionByCoordSetObservable=function(){return this.positionByCoordSetSubject},e}(r.a);f=u([n.i(o.c)(),l("design:paramtypes",["function"==typeof(p=void 0!==s.a&&s.a)&&p||Object,"function"==typeof(d=void 0!==c.Ng2BalloonMsgService&&c.Ng2BalloonMsgService)&&d||Object])],f);var p,d},"6ql+":function(t,e,n){"use strict";var o=n("wuWp");n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.items=function(t){return t.items},e}(o.a)},"84OX":function(t,e,n){"use strict";function o(t,e){if(null==t||0==t.length)throw new Error("modelSetkey is None or zero length");if(null==e||0==e.length)throw new Error("dispKey is None or zero length");for(var n=0,o=0;o<e.length;o++)n=(n<<5)-n+e.charCodeAt(o),n|=0;return n&=1023,t+":"+n}var r=n("/oeL"),i=n("3mKK"),s=n("yMcj"),c=(n.n(s),n("vHfq")),a=n("ge1L"),u=(n.n(a),n("QXLL")),l=n("pXRQ"),f=n("sZSy"),p=n("Dqrr");n.n(p);n.d(e,"a",function(){return m});var d=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),h=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},y=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},v=n("Ad+1"),_=n.i(s.extend)({key:"clientLocationIndexWatchUpdateFromDevice"},c.a),g=function(t){function e(e){return t.call(this,i.a.tupleName,{key:e})||this}return d(e,t),e}(s.TupleSelector),b=function(t){function e(e){return t.call(this,u.a.tupleName,{modelSetKey:e})||this}return d(e,t),e}(s.TupleSelector),m=function(){function t(t,e,n,o){this.vortexService=t,this.vortexStatusService=e,this.coordSetService=o,this.indexByModelSet={},this.storage=new s.TupleOfflineStorageService(n,new s.TupleOfflineStorageNameService(c.d))}return t.prototype.indexForModelSetKey=function(t){var e=null;if(this.indexByModelSet.hasOwnProperty(t)){if(e=this.indexByModelSet[t],e.isReady())return Promise.resolve(e)}else e=new P(this.vortexService,this.vortexStatusService,this.storage,t,this.coordSetService),this.indexByModelSet[t]=e;return new Promise(function(t,n){e.isReadyObservable().first().subscribe(function(){t(e)})})},t}();m=h([n.i(r.c)(),y("design:paramtypes",["function"==typeof(S=void 0!==s.VortexService&&s.VortexService)&&S||Object,"function"==typeof(w=void 0!==s.VortexStatusService&&s.VortexStatusService)&&w||Object,"function"==typeof(O=void 0!==s.TupleStorageFactoryService&&s.TupleStorageFactoryService)&&O||Object,"function"==typeof(j=void 0!==f.a&&f.a)&&j||Object])],m);var S,w,O,j,P=function(){function t(t,e,n,o,r){this.vortexService=t,this.vortexStatusService=e,this.storage=n,this.modelSetKey=o,this.coordSetService=r,this.indexBucketUpdateDates={},this.lifecycleEmitter=new s.ComponentLifecycleEventEmitter,this._hasLoaded=!1,this._hasLoadedSubject=new p.Subject,this.initialLoad()}return t.prototype.isReady=function(){return this._hasLoaded},t.prototype.isReadyObservable=function(){return this._hasLoadedSubject},t.prototype.initialLoad=function(){var t=this;this.storage.loadTuples(new b(this.modelSetKey)).then(function(e){0!=e.length&&(t.indexBucketUpdateDates=e[0].indexBucketUpdateDates,t.vortexStatusService.snapshot.isOnline&&(t._hasLoaded=!0,t._hasLoadedSubject.next())),t.setupVortexSubscriptions(),t.askServerForUpdates()})},t.prototype.setupVortexSubscriptions=function(){var t=this,e=n.i(s.extend)({modelSetKey:this.modelSetKey},_);this.vortexService.createEndpointObservable(this.lifecycleEmitter,e).takeUntil(this.lifecycleEmitter.onDestroyEvent).subscribe(function(e){return t.processLocationIndexesFromServer(e)}),this.vortexStatusService.isOnline.filter(function(t){return 1==t}).takeUntil(this.lifecycleEmitter.onDestroyEvent).subscribe(function(){return t.askServerForUpdates()})},t.prototype.askServerForUpdates=function(){if(this.vortexStatusService.snapshot.isOnline){var t=new u.a;t.indexBucketUpdateDates=this.indexBucketUpdateDates;var e=n.i(s.extend)({modelSetKey:this.modelSetKey},_),o=new s.Payload(e,[t]);this.vortexService.sendPayload(o)}},t.prototype.processLocationIndexesFromServer=function(t){var e=this;if(null!=t.result&&1!=t.result)return void console.log(t.result);if(1==t.filt.finished)return this._hasLoaded=!0,void this._hasLoadedSubject.next();for(var n=t.tuples,o=[],r=0,i=n;r<i.length;r++){var s=i[r],c=this.indexBucketUpdateDates[s.indexBucket];if(null!=c){var l=a(c);if(a(s.lastUpdate).isBefore(l))continue}o.push(s)}this.storeLocationIndexTuples(o).then(function(){for(var t=0,n=o;t<n.length;t++){var r=n[t];e.indexBucketUpdateDates[r.indexBucket]=r.lastUpdate}var i=new u.a;return i.modelSetKey=e.modelSetKey,i.indexBucketUpdateDates=e.indexBucketUpdateDates,e.storage.saveTuples(new b(e.modelSetKey),[i])}).catch(function(t){return console.log("LocationIndexCache.storeLocationIndexTuples: "+t)})},t.prototype.storeLocationIndexTuples=function(t){return this.storage.transaction(!0).then(function(e){for(var n=[],o=0,r=t;o<r.length;o++){var i=r[o];n.push(e.saveTuplesEncoded(new g(i.indexBucket),i.encodedThisTuple))}return Promise.all(n).then(function(){return e.close()}).catch(function(t){return console.log("LocationIndexCache.storeLocationIndexTuples: "+t)})})},t.prototype.getLocations=function(t){var e=this;if(null==t||0==t.length){var n=[];return Promise.resolve(n)}var r=o(this.modelSetKey,t);if(!this.indexBucketUpdateDates.hasOwnProperty(r))return console.log("DispKey "+t+" doesn't appear in the index"),Promise.resolve([]);return this.storage.loadTuples(new g(r)).then(function(n){if(0==n.length)return[];if(1!=n.length)throw new Error("We received more tuples then expected");for(var o=v.inflate(n[0].blobData,{to:"string"}),r=JSON.parse(o),i=null,s=0;s<r.length;s++)if(r[s][0]==t){i=r[s].slice(1);break}if(null==i)return[];for(var c=[],a=0,u=i;a<u.length;a++){var f=u[a],p=l.a.fromLocationJson(f);p.coordSetKey=e.coordSetService.coordSetForId(p.coordSetId).key,c.push(p)}return c})},t}()},"8Sw2":function(t,e,n){function o(t){return n(r(t))}function r(t){var e=i[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var i={"./af":"FQor","./af.js":"FQor","./ar":"EcI0","./ar-dz":"cw72","./ar-dz.js":"cw72","./ar-kw":"fu+8","./ar-kw.js":"fu+8","./ar-ly":"7CVz","./ar-ly.js":"7CVz","./ar-ma":"1dFW","./ar-ma.js":"1dFW","./ar-sa":"UxV2","./ar-sa.js":"UxV2","./ar-tn":"nm31","./ar-tn.js":"nm31","./ar.js":"EcI0","./az":"EbpX","./az.js":"EbpX","./be":"SQlX","./be.js":"SQlX","./bg":"R3V+","./bg.js":"R3V+","./bn":"cAX3","./bn.js":"cAX3","./bo":"dHgA","./bo.js":"dHgA","./br":"W7ww","./br.js":"W7ww","./bs":"lZ6K","./bs.js":"lZ6K","./ca":"udbC","./ca.js":"udbC","./cs":"oSQb","./cs.js":"oSQb","./cv":"yPEm","./cv.js":"yPEm","./cy":"PpYB","./cy.js":"PpYB","./da":"oiZG","./da.js":"oiZG","./de":"LYe6","./de-at":"KOG5","./de-at.js":"KOG5","./de-ch":"o3JY","./de-ch.js":"o3JY","./de.js":"LYe6","./dv":"OkYT","./dv.js":"OkYT","./el":"QFnp","./el.js":"QFnp","./en-au":"dBGl","./en-au.js":"dBGl","./en-ca":"vv0C","./en-ca.js":"vv0C","./en-gb":"IoCy","./en-gb.js":"IoCy","./en-ie":"qVAg","./en-ie.js":"qVAg","./en-nz":"FbT0","./en-nz.js":"FbT0","./eo":"y/6j","./eo.js":"y/6j","./es":"ivpd","./es-do":"DBbP","./es-do.js":"DBbP","./es.js":"ivpd","./et":"FrUj","./et.js":"FrUj","./eu":"LAVD","./eu.js":"LAVD","./fa":"J2cK","./fa.js":"J2cK","./fi":"5FCP","./fi.js":"5FCP","./fo":"jIZb","./fo.js":"jIZb","./fr":"Lq8I","./fr-ca":"ICRA","./fr-ca.js":"ICRA","./fr-ch":"QWmo","./fr-ch.js":"QWmo","./fr.js":"Lq8I","./fy":"Fbnp","./fy.js":"Fbnp","./gd":"zhFu","./gd.js":"zhFu","./gl":"o10m","./gl.js":"o10m","./gom-latn":"UoXv","./gom-latn.js":"UoXv","./he":"gbvS","./he.js":"gbvS","./hi":"+UQz","./hi.js":"+UQz","./hr":"qGYH","./hr.js":"qGYH","./hu":"hGGh","./hu.js":"hGGh","./hy-am":"1AR5","./hy-am.js":"1AR5","./id":"Ie9h","./id.js":"Ie9h","./is":"piS+","./is.js":"piS+","./it":"5P9/","./it.js":"5P9/","./ja":"3cRe","./ja.js":"3cRe","./jv":"vwCJ","./jv.js":"vwCJ","./ka":"R7aq","./ka.js":"R7aq","./kk":"d8hV","./kk.js":"d8hV","./km":"nCdc","./km.js":"nCdc","./kn":"5K8n","./kn.js":"5K8n","./ko":"1jN3","./ko.js":"1jN3","./ky":"74/W","./ky.js":"74/W","./lb":"XAyT","./lb.js":"XAyT","./lo":"w/Mz","./lo.js":"w/Mz","./lt":"IetG","./lt.js":"IetG","./lv":"CRPd","./lv.js":"CRPd","./me":"1mee","./me.js":"1mee","./mi":"yRr3","./mi.js":"yRr3","./mk":"bfn1","./mk.js":"bfn1","./ml":"r1ky","./ml.js":"r1ky","./mr":"+K6p","./mr.js":"+K6p","./ms":"asMk","./ms-my":"IcWU","./ms-my.js":"IcWU","./ms.js":"asMk","./my":"Isng","./my.js":"Isng","./nb":"FjNp","./nb.js":"FjNp","./ne":"P9zQ","./ne.js":"P9zQ","./nl":"pejQ","./nl-be":"c3/i","./nl-be.js":"c3/i","./nl.js":"pejQ","./nn":"ALD8","./nn.js":"ALD8","./pa-in":"1YTd","./pa-in.js":"1YTd","./pl":"Gs99","./pl.js":"Gs99","./pt":"eunO","./pt-br":"uHKL","./pt-br.js":"uHKL","./pt.js":"eunO","./ro":"1FZw","./ro.js":"1FZw","./ru":"Cy48","./ru.js":"Cy48","./sd":"+28k","./sd.js":"+28k","./se":"EiHj","./se.js":"EiHj","./si":"77bI","./si.js":"77bI","./sk":"BgyH","./sk.js":"BgyH","./sl":"K7sG","./sl.js":"K7sG","./sq":"pwQJ","./sq.js":"pwQJ","./sr":"N0T2","./sr-cyrl":"9OoP","./sr-cyrl.js":"9OoP","./sr.js":"N0T2","./ss":"Mh9L","./ss.js":"Mh9L","./sv":"YZAt","./sv.js":"YZAt","./sw":"/7jV","./sw.js":"/7jV","./ta":"VKBt","./ta.js":"VKBt","./te":"TIcV","./te.js":"TIcV","./tet":"BlC1","./tet.js":"BlC1","./th":"Zi3L","./th.js":"Zi3L","./tl-ph":"D4Y9","./tl-ph.js":"D4Y9","./tlh":"muBP","./tlh.js":"muBP","./tr":"82s3","./tr.js":"82s3","./tzl":"vjXv","./tzl.js":"vjXv","./tzm":"Vhfe","./tzm-latn":"m0Pg","./tzm-latn.js":"m0Pg","./tzm.js":"Vhfe","./uk":"Y3Ex","./uk.js":"Y3Ex","./ur":"4DIg","./ur.js":"4DIg","./uz":"wDue","./uz-latn":"Li28","./uz-latn.js":"Li28","./uz.js":"wDue","./vi":"UbP6","./vi.js":"UbP6","./x-pseudo":"fQLM","./x-pseudo.js":"fQLM","./yo":"evMD","./yo.js":"evMD","./zh-cn":"DV5H","./zh-cn.js":"DV5H","./zh-hk":"iEKH","./zh-hk.js":"iEKH","./zh-tw":"X9uL","./zh-tw.js":"X9uL"};o.keys=function(){return Object.keys(i)},o.resolve=r,t.exports=o,o.id="8Sw2"},"8Wrx":function(t,e,n){"use strict";var o=n("tmW9");n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.renderFactory=n,r.dispGroupCache=o,r}return r(e,t),e.prototype.draw=function(t,e,n,o){var r=this.dispGroupCache.dispGroupForId(t.gid);if(null!=r){var i=t.g[0],s=t.g[1],c=t.r/180*Math.PI,a=t.vs,u=t.hs;e.save(),e.translate(i,s),e.rotate(c),e.scale(a,u);for(var l=0;l<r.length;l++){var f=r[l];this.renderFactory.draw(f,e,n,o)}e.restore()}},e.prototype.drawSelected=function(t,e,n,o){},e.prototype.contains=function(t,e,n,o){return!1},e.prototype.withIn=function(t,e,n,o,r){return!1},e.prototype.handles=function(t){return[]},e.prototype.deltaMove=function(t,e,n){},e.prototype.area=function(t){return 0},e}(o.a)},"99Qt":function(t,e,n){"use strict";function o(t){return t.preventDefault(),!1}e.a=o,n.d(e,"b",function(){return i});var r=function(){function t(){this.x=0,this.y=0,this.clientX=0,this.clientY=0}return t}(),i=(function(){function t(){this.x=0,this.y=0}}(),function(){function t(t){this.NAME=t,this._CanvasInput=null,this._lastMousePos=new r,this.DRAG_START_THRESHOLD=5,this.DRAG_TIME_THRESHOLD=200}return t.prototype._hasPassedDragThreshold=function(t,e){var n=!1;return n=n||e.time.getTime()-t.time.getTime()>this.DRAG_TIME_THRESHOLD,n=n||Math.abs(t.x-e.x)>this.DRAG_START_THRESHOLD,n=n||Math.abs(t.y-e.y)>this.DRAG_START_THRESHOLD},t.prototype.keyDown=function(t){},t.prototype.keyPress=function(t){},t.prototype.keyUp=function(t){},t.prototype.mouseSelectStart=function(t,e){},t.prototype.mouseDown=function(t,e){},t.prototype.mouseMove=function(t,e){},t.prototype.mouseUp=function(t,e){},t.prototype.mouseDoubleClick=function(t,e){},t.prototype.mouseWheel=function(t,e){},t.prototype.touchStart=function(t,e){},t.prototype.touchMove=function(t,e){},t.prototype.touchEnd=function(t,e){},t.prototype.shutdown=function(){},t.prototype.draw=function(t){},t.prototype._setLastMousePos=function(t){var e=t.x-this._lastMousePos.x,n=t.y-this._lastMousePos.y,o=t.clientX-this._lastMousePos.clientX,r=t.clientY-this._lastMousePos.clientY;return this._lastMousePos.x+=e,this._lastMousePos.y+=n,this._lastMousePos.clientX+=o,this._lastMousePos.clientY+=r,{dx:e,dy:n,dClientX:o,dClientY:r}},t}())},AHZm:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){var e=t.call(this,u.tupleName)||this;return e.data={},e}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"GridCacheIndexTuple",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},B9O1:function(t,e,n){"use strict";function o(){return new Date}var r=n("cyHF"),i=n("wuWp"),s=n("Dqrr");n.n(s);n.d(e,"a",function(){return c});var c=function(){function t(t,e,n,o){var r=this;this.config=t,this.gridObservable=e,this.lookupCache=n,this.lifecycleEventEmitter=o,this._coordSetId=null,this._gridBuffer={},this._viewingGridKeysDict={},this._viewingGridKeysStr="",this._visableDisps=[],this._selection=[],this._selectionChangedSubject=new s.Subject,this.needsUpdate=!1,this.needsCompiling=!1,this.isUpdating=!1,this.needsUpdate=!1,setInterval(function(){return r._checkGridKeysForArea()},this.config.controller.updateInterval),setInterval(function(){return r._compileDisps()},this.config.controller.updateInterval),this.gridObservable.observableForCanvas(this.config.canvasId).takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(t){return r._receiveGrid([t])}),this.lifecycleEventEmitter.onDestroyEvent.subscribe(function(){r.gridObservable.unsubscribeCanvas(r.config.canvasId)}),this.config.controller.coordSetChange.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(t){null==t?(r.config.updateViewPortPan({x:0,y:0}),r.config.updateViewPortZoom(1),r._coordSetId=null):(r.config.updateViewPortPan({x:t.initialPanX,y:t.initialPanY}),r.config.updateViewPortZoom(t.initialZoom),r._coordSetId=t.id),r.reset(),r.needsUpdate=!0}),this.config.viewPort.windowChange.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(){return r.needsUpdate=!0})}return t.prototype.selectionChangedObservable=function(){return this._selectionChangedSubject},t.prototype.reset=function(){this.needsUpdate=!1,this.isUpdating=!1,this._selection=[],this._visableDisps=[],this._gridBuffer={},this._viewingGridKeysDict={},this._viewingGridKeysStr=""},t.prototype._checkGridKeysForArea=function(){if(null!=this._coordSetId&&this.needsUpdate&&(this.needsUpdate=!1,this.lookupCache.isReady())){var t=this.config.viewPort.window,e=this.config.viewPort.zoom,o=this.config.controller.coordSet.gridKeysForArea(t,e);if(o.join()!=this._viewingGridKeysStr){this._viewingGridKeysStr=o.join(),this._viewingGridKeysDict=n.i(r.e)(o);for(var i=0,s=n.i(r.b)(this._gridBuffer);i<s.length;i++){var c=s[i];this._viewingGridKeysDict.hasOwnProperty(c)||delete this._gridBuffer[c]}this.gridObservable.updateDiagramWatchedGrids(this.config.canvasId,o)}}},t.prototype._receiveGrid=function(t){for(var e=0,n=t;e<n.length;e++){var o=n[e];if(console.log("PeekCanvasModel: Received grid "+o.gridKey+",  "+o.lastUpdate),o.hasData()&&this._viewingGridKeysDict.hasOwnProperty(o.gridKey)){var r=this._gridBuffer[o.gridKey];null!=r&&r.lastUpdate==o.lastUpdate||(console.log("PeekCanvasModel: Applying grid "+o.gridKey+",  "+o.lastUpdate),this._gridBuffer[o.gridKey]=o,this.needsCompiling=!0)}}},t.prototype.viewableDisps=function(){return this._visableDisps},t.prototype.selectableDisps=function(){return this.viewableDisps().filter(function(t){return i.a.isSelectable(t)})},t.prototype.selectedDisps=function(){return this._selection},t.prototype._compileDisps=function(){if(this.needsCompiling&&(this.needsCompiling=!1,null!=this._coordSetId)){for(var t=o(),e=this.lookupCache.levelsOrderedByOrder(this._coordSetId),s=this.lookupCache.layersOrderedByOrder(),c=(this.config.viewPort.zoom,{}),a=[],u={},l=n.i(r.b)(this._viewingGridKeysDict),f=0;f<e.length;f++)for(var p=e[f],d=0;d<s.length;d++){var h=s[d];if(h.visible)for(var y=0;y<l.length;y++){var v=l[y],_=this._gridBuffer[v];if(null!=_){var g=c[v];if(null==g&&(g=0),!(g>=_.disps.length)){for(;g<_.disps.length;g++){var b=_.disps[g];if(!(i.a.level(b).order<p.order)){if(p.order<i.a.level(b).order)break;if(!(i.a.layer(b).order<h.order)){if(h.order<i.a.layer(b).order)break;!0!==u[b.id]&&(a.push(b),u[b.id]=!0)}}}c[v]=g}}}}this._visableDisps=a,this.config.model.dispOnScreen=a.length,this.config.invalidate();var m=o()-t;console.log(n.i(r.f)()+" Model: compileDisps took "+m+"ms for "+a.length+" disps and "+l.length+" grids")}},t.prototype.addSelection=function(t){this._selection=this._selection.add(t),this.config.invalidate(),this._selectionChangedSubject.next(this._selection)},t.prototype.removeSelection=function(t){this._selection=this._selection.remove(t),this.config.invalidate(),this._selectionChangedSubject.next(this._selection)},t.prototype.clearSelection=function(){this._selection=[],this.config.invalidate(),this._selectionChangedSubject.next(this._selection)},t}()},BL84:function(t,e,n){"use strict";var o=n("LjK0"),r=n("EOMf"),i=n("nHty"),s=n("V4he"),c=n("jGMM"),a=n("8Wrx"),u=n("wuWp"),l=n("+8ml");n.d(e,"a",function(){return f});var f=function(){function t(t,e){var n=new r.a(t),o=new i.a(t),u=new s.a(t),l=new c.a(t),f=new a.a(t,this,e);this._delegatesByType={DT:o,DPG:n,DPL:n,DE:u,DA:l,DGP:f}}return t.prototype._initBounds=function(t){null==t.bounds&&(t.bounds=o.a.fromGeom(t.g))},t.prototype.draw=function(t,e,n,o){var r=u.a.level(t);r.minZoom<=n&&n<=r.maxZoom&&(null==this._delegatesByType[t._tt]&&console.log(t._tt),this._delegatesByType[t._tt].draw(t,e,n,o))},t.prototype.drawSelected=function(t,e,n,o){this._delegatesByType[t._tt].drawSelected(t,e,n,o)},t.prototype.contains=function(t,e,n,o){return this._initBounds(t),this._delegatesByType[t._tt].contains(t,e,n,o)},t.prototype.withIn=function(t,e,n,o,r){return this._initBounds(t),this._delegatesByType[t._tt].withIn(t,e,n,o,r)},t.prototype.similarTo=function(t,e){return!1},t.prototype.handles=function(t){return this._delegatesByType[t._tt].handles(t)},t.prototype.deltaMove=function(t,e,n){return this._initBounds(t),this._delegatesByType[t._tt].deltaMove(e,n)},t.prototype.area=function(t){return this._initBounds(t),this._delegatesByType[t._tt].area(t)},t.prototype.selectionPriotityCompare=function(t,e){return l.a.type(t)==l.b.polygon&&l.a.type(e)!=l.b.polygon?1:this._delegatesByType[e._tt].area()-this._delegatesByType[t._tt].area()},t}()},D4RW:function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("GP/Y")),s=n("BL84"),c=n("g9Jp"),a=n("+smj"),u=n("B9O1"),l=n("DBLw"),f=n("cbTp"),p=n("FF/L"),d=n("wuWp"),h=n("S4Bb"),y=(n.n(h),n("LjK0")),v=n("HzwN"),_=n("HsD/"),g=n("sZSy");n.d(e,"a",function(){return w});var b=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},S=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},w=function(t){function e(e,n,o,r,l,f){var p=t.call(this)||this;return p.gridObservable=e,p.lookupCache=n,p.coordSetCache=o,p.dispGroupCache=r,p.itemSelectService=f,p.canvas=null,p.coordSetId=null,p.lastCanvasSize="",p.lastWindowHeight=0,p._privatePosService=l,p.config=new i.a,p.model=new u.a(p.config,e,n,p),p.dispDelegate=new s.a(p.config,r),p.input=new a.a(p.config,p.model,p.dispDelegate,p),p.renderer=new c.a(p.config,p.model,p.dispDelegate,p),p.renderer.drawEvent.takeUntil(p.onDestroyEvent).subscribe(function(t){return p.input.draw(t)}),p.connectItemSelectionService(),p.connectDiagramService(),p.connectPositionUpdateNotify(),p}return b(e,t),e.prototype.isReady=function(){return this.coordSetCache.isReady()&&this.gridObservable.isReady()&&this.lookupCache.isReady()},e.prototype.ngOnInit=function(){var t=this;this.dispGroupCache.setModelSetKey(this.modelSetKey),this.lookupCache.setModelSetKey(this.modelSetKey),this.canvas=this.canvasView.nativeElement,this.input.setCanvas(this.canvas),this.renderer.setCanvas(this.canvas);var e=h(this.canvas);h("body").css("overflow","hidden"),this.doCheckEvent.takeUntil(this.onDestroyEvent).subscribe(function(){var n=h(window).height();if(t.lastWindowHeight!=n){t.lastWindowHeight=n;var o=n-e.offset().top;e.css("height",o+"px"),e.css("width","100%")}}),this.doCheckEvent.takeUntil(this.onDestroyEvent).subscribe(function(){var n=e.offset(),o=new y.a(n.left,n.top,e.width(),e.height()),r=o.toString();t.lastCanvasSize!=r&&(t.lastCanvasSize=r,t.canvas.height=t.canvas.clientHeight,t.canvas.width=t.canvas.clientWidth,t.config.updateCanvasWindow(o))})},e.prototype.mouseInfo=function(){return this.config.mouse.currentViewPortPosition.x.toFixed(2)+"x"+this.config.mouse.currentViewPortPosition.y.toFixed(2)+"X"+this.config.viewPort.zoom.toFixed(2)+", "+this.config.model.dispOnScreen+" Items"},e.prototype.switchToCoordSet=function(t){if(this.isReady()){var e=this.coordSetCache.coordSetForKey(t);this.config.updateCoordSet(e),this._privatePosService.setTitle("Viewing "+e.name),this.config.updateCoordSet(e),this._privatePosService.setReady(!0)}},e.prototype.connectPositionUpdateNotify=function(){var t=this,e=function(){null!=t.config.controller.coordSet&&t._privatePosService.positionUpdated({coordSetKey:t.config.controller.coordSet.key,x:t.config.viewPort.pan.x,y:t.config.viewPort.pan.y,zoom:t.config.viewPort.zoom})};this.config.viewPort.panChange.takeUntil(this.onDestroyEvent).subscribe(e),this.config.viewPort.zoomChange.takeUntil(this.onDestroyEvent).subscribe(e),this.config.controller.coordSetChange.takeUntil(this.onDestroyEvent).subscribe(e)},e.prototype.connectItemSelectionService=function(){var t=this;this.model.selectionChangedObservable().takeUntil(this.onDestroyEvent).subscribe(function(e){1==e.length&&t.itemSelectService.selectItem({modelSetKey:t.modelSetKey,coordSetKey:t.config.controller.coordSet.key,dispKey:d.a.key(e[0]),dispData:d.a.data(e[0])})})},e.prototype.connectDiagramService=function(){var t=this,e=this.doCheckEvent.takeUntil(this.onDestroyEvent).subscribe(function(){t.isReady()&&(e.unsubscribe(),t._privatePosService.setReady(!0))});this._privatePosService.positionByCoordSetObservable().takeUntil(this.onDestroyEvent).subscribe(function(e){if(!t.isReady())return void console.log("ERROR, Position was called before canvas is ready");t.switchToCoordSet(e)}),this._privatePosService.positionObservable().takeUntil(this.onDestroyEvent).subscribe(function(e){null!=t.config.controller.coordSet&&t.config.controller.coordSet.key==e.coordSetKey||t.switchToCoordSet(e.coordSetKey),t.config.updateViewPortPan({x:e.x,y:e.y}),t.config.updateViewPortZoom(e.zoom)})},e}(r.ComponentLifecycleEventEmitter);m([n.i(o.g)("canvas"),S("design:type",Object)],w.prototype,"canvasView",void 0),m([n.i(o.h)("modelSetKey"),S("design:type",String)],w.prototype,"modelSetKey",void 0),w=m([n.i(o.f)({selector:"pl-diagram-canvas",template:n("nHid"),styles:[n("lt2r")]}),S("design:paramtypes",["function"==typeof(O=void 0!==l.a&&l.a)&&O||Object,"function"==typeof(j=void 0!==f.a&&f.a)&&j||Object,"function"==typeof(P=void 0!==g.a&&g.a)&&P||Object,"function"==typeof(x=void 0!==p.a&&p.a)&&x||Object,"function"==typeof(R=void 0!==v.a&&v.a)&&R||Object,"function"==typeof(T=void 0!==_.a&&_.a)&&T||Object])],w);var O,j,P,x,R,T},DBLw:function(t,e,n){"use strict";var o=n("/oeL"),r=n("tRBE"),i=n("rlar"),s=(n.n(i),n("cyHF"));n.d(e,"a",function(){return u});var c=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t){var e=this;this.gridCache=t,this.subjectByCanvasId={},this.gridKeysByCanvasId={},this.canvasIdsByGidKey={},this.lastObservedKeysStr="",this.gridCache.observable.subscribe(function(t){return e.processGridUpdates(t)})}return t.prototype.isReady=function(){return this.gridCache.isReady()},t.prototype.unsubscribeCanvas=function(t){delete this.gridKeysByCanvasId[t],delete this.subjectByCanvasId[t],this.rebuildReverseLookup(),this.updateGridCacheWatchedKeys()},t.prototype.observableForCanvas=function(t){return n.i(s.a)(!this.subjectByCanvasId.hasOwnProperty(t),"Canvas "+t+" has already requested a subhect"),this.subjectByCanvasId[t]=new i.Subject,this.subjectByCanvasId[t]},t.prototype.updateDiagramWatchedGrids=function(t,e){this.gridKeysByCanvasId[t]=e,this.rebuildReverseLookup(),this.updateGridCacheWatchedKeys()},t.prototype.processGridUpdates=function(t){if(this.canvasIdsByGidKey.hasOwnProperty(t.gridKey))for(var e=this.canvasIdsByGidKey[t.gridKey],n=0,o=e;n<o.length;n++){var r=o[n];this.subjectByCanvasId[r].next(t)}},t.prototype.updateGridCacheWatchedKeys=function(){var t=n.i(s.b)(this.canvasIdsByGidKey).sort(),e=t.join(",");this.lastObservedKeysStr!=e&&(this.lastObservedKeysStr=e,this.gridCache.updateWatchedGrids(t))},t.prototype.rebuildReverseLookup=function(){for(var t={},e=0,o=n.i(s.b)(this.gridKeysByCanvasId);e<o.length;e++)for(var r=o[e],i=this.gridKeysByCanvasId[r],c=0,a=i;c<a.length;c++){var u=a[c],l=null;t.hasOwnProperty(u)?l=t[u]:t[u]=l=[],l.push(r)}this.canvasIdsByGidKey=t},t}();u=c([n.i(o.c)(),a("design:paramtypes",["function"==typeof(l=void 0!==r.a&&r.a)&&l||Object])],u);var l},EOMf:function(t,e,n){"use strict";var o=n("tmW9"),r=n("pibO"),i=n("+8ml"),s=n("LjK0");n.d(e,"a",function(){return a});var c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=function(t){function e(e){return t.call(this,e)||this}return c(e,t),e.prototype._drawLine=function(t,e,n,o,r,i,s){if(null==i.dashPattern)return void t.lineTo(o,r);var c=i.dashPattern[0]/s;t.moveTo(e,n);for(var a=o-e,u=r-n,l=Math.floor(Math.sqrt(a*a+u*u)/c),f=a/l,p=u/l,d=0;d++<l;)e+=f,n+=p,t[d%2==0?"moveTo":"lineTo"](e,n);t[d%2==0?"moveTo":"lineTo"](o,r)},e.prototype.draw=function(t,e,n,o){var c=i.a.type(t)==i.b.polygon,a=c?r.a.fillColor(t):null,u=r.a.lineColor(t),l=r.a.lineStyle(t);if(a=a&&a.color?a:null,u=l&&u&&u.color?u:null,a||u){var f=r.a.fillDirection(t),p=r.a.fillPercent(t),d=r.a.geom(t),h=d[0],y=d[1];if(u&&l.backgroundFillDashSpace){e.beginPath(),e.moveTo(h,y);for(var v=2;v<d.length;v+=2){var _=d[v],g=d[v+1];e.lineTo(_,g)}e.strokeStyle=this.config.renderer.backgroundColor,e.lineWidth=r.a.lineWidth(t)/n,e.stroke()}e.beginPath(),e.moveTo(h,y);for(var b=h,m=y,v=2;v<d.length;v+=2){var _=d[v],g=d[v+1];this._drawLine(e,b,m,_,g,l,n),b=_,m=g}c&&e.closePath(),u&&(e.strokeStyle=u.color,e.lineWidth=r.a.lineWidth(t)/n,e.stroke()),a&&(c&&null!=f&&null!=p?this._drawSquarePercentFill(e,s.a.fromGeom(d),a,f,p):(e.fillStyle=a.color,e.fill()))}},e.prototype._drawSquarePercentFill=function(t,e,n,o,r){if(0==o)e.h*=r/100;else if(1==o){var i=e.h;e.h*=r/100,e.y+=i-e.h}else if(2==o){var s=e.w;e.w*=r/100,e.x+=s-e.w}else 3==o&&(e.w*=r/100);t.fillStyle=n.color,t.fillRect(e.x,e.y,e.w,e.h)},e.prototype.drawSelected=function(t,e,n,o){var i=r.a.geom(t),c=this.config.renderer.selection,a=s.a.fromGeom(i),u=(c.width+c.lineGap)/n,l=2*u,f=a.x-u,p=a.y-u,d=a.w+l,h=a.h+l;e.dashedRect(f,p,d,h,c.dashLen/n),e.strokeStyle=c.color,e.lineWidth=c.width/n,e.stroke()},e.prototype.contains=function(t,e,n,o){var c=r.a.geom(t);return!!s.a.fromGeom(c).contains(e,n,o)&&(i.a.type(t)==i.b.polygon?this.polygonContains(c,t,e,n,o):this.polylineContains(c,t,e,n,o))},e.prototype.polygonContains=function(t,e,n,o,r){for(var i=0,s=t[0],c=t[1],a=s,u=c,l=2;l<=t.length;l+=2){var f=s,p=c;l!=t.length&&(f=t[l],p=t[l+1]),function(t,e,r,i){var s=e>i,c=s?r:t,a=s?i:e,u=s?t:r,l=s?e:i;if(o!=a&&o!=l||(o+=1e-8),o>l||o<a||n>Math.max(c,u))return!1;if(n<Math.min(c,u))return!0;var f=c!=u?(l-a)/(u-c):1/0;return(c!=n?(o-a)/(n-c):1/0)>=f}(a,u,f,p)&&i++,a=f,u=p}return i%2==1},e.prototype.xxx=function(){return!1},e.prototype.polylineContains=function(t,e,n,o,r){for(var i=t[0],s=t[1],c=2;c<t.length;c+=2){var a=t[c],u=t[c+1],l=a-i,f=u-s,p=(i<a?i:a)-r,d=(i<a?a:i)+r,h=(s<u?s:u)-r,y=(s<u?u:s)+r;if(0==l&&p<=n&&n<=d&&h<=o&&o<=y)return!0;var v=f/l,_=s-v*i,g=v*n+_,b=(o-_)/v;if((o-r<g&&g<o+r||n-r<b&&b<n+r)&&p<=n&&n<=d&&h<=o&&o<=y)return!0;i=a,s=u}return!1},e.prototype.withIn=function(t,e,n,o,r){return!1},e.prototype.handles=function(t){return[]},e.prototype.deltaMove=function(t,e,n){},e.prototype.area=function(t){return 0},e}(o.a)},EOrj:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(e,n,o,r){if(void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),e instanceof t)return this.x=parseFloat(e.x.toString()),this.y=parseFloat(e.y.toString()),this.w=parseFloat(e.w.toString()),void(this.h=parseFloat(e.h.toString()));this.x=0,this.y=0,this.w=0,this.h=0,e&&(this.x=parseFloat(e.toString())),n&&(this.y=parseFloat(n.toString())),o&&(this.w=parseFloat(o.toString())),r&&(this.h=parseFloat(r.toString())),this.w<0&&(this.w*=-1,this.x=this.x-this.w),this.h<0&&(this.h*=-1,this.y=this.y-this.h)}return t.fromGeom=function(e){for(var n=new t,o=e[0],r=e[1],i=o,s=o,c=r,a=r,u=2;u<e.length;u+=2){var l=e[u],f=e[u+1];l<i&&(i=l),s<l&&(s=l),f<c&&(c=f),a<f&&(a=f)}return n.x=i,n.y=c,n.w=s-i,n.h=a-c,n},t.prototype.contains=function(t,e,n){var o=this,r=o.x-n/2,i=o.x+o.w+n/2,s=o.y-n/2,c=o.y+o.h+n/2;return r<=t&&t<=i&&s<=e&&e<=c},t.prototype.withIn=function(e,n,o,r){e instanceof t&&(n=e.y,o=e.w,r=e.h,e=e.x);var i=this;return e<=i.x&&i.x+i.w<=e+o&&n<=i.y&&i.y+i.h<=n+r},t.prototype.isEqual=function(e){return e instanceof t&&(this.x===e.x&&this.y===e.y&&this.w===e.w&&this.h===e.h)},t.prototype.area=function(){return this.w*this.h},t.prototype.toString=function(){return this.x+"x,"+this.y+"y,"+this.w+"w,"+this.h+"h"},t}()},"FF/L":function(t,e,n){"use strict";var o=n("/oeL");n.d(e,"a",function(){return s});var r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},s=function(){function t(){this.modelSetKey=""}return t.prototype.setModelSetKey=function(t){this.modelSetKey=t},t.prototype.dispGroupForId=function(t){return[]},t}();s=r([n.i(o.c)(),i("design:paramtypes",[])],s)},FPdV:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"DispLevel",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"GP/Y":function(t,e,n){"use strict";var o=n("Dqrr"),r=(n.n(o),n("LjK0"));n.d(e,"a",function(){return i});var i=function(){function t(){this.controller={updateInterval:400,coordSetChange:new o.Subject,coordSet:null},this.renderer={invalidate:new o.Subject,drawInterval:60,backgroundColor:"black",selection:{color:"white",width:8,lineGap:6,dashLen:3,snapSize:4},grid:{show:!1,size:16,color:"#CCC",font:"12px Arial",lineWidth:1,snapDashedLen:2}},this.viewPort={windowChange:new o.Subject,window:new r.a,zoomChange:new o.Subject,panChange:new o.Subject,pan:{x:238255,y:124655},zoom:.5,minZoom:.01,maxZoom:10},this.canvas={windowChange:new o.Subject,window:new r.a},this.mouse={currentDelegateName:null,phUpDownZoomFactor:20,currentViewPortPosition:{x:0,y:0},currentCanvasPosition:{x:0,y:0},selecting:{color:"#3399FF",width:2,lineGap:2,dashLen:3,snapSize:4,margin:5}},this.model={gridsWaitingForData:0,dispOnScreen:0},this.debug={},this.canvasId=t.canvasIdCounter++}return t.prototype.invalidate=function(){this.renderer.invalidate.next()},t.prototype.updateViewPortPan=function(t){this.viewPort.pan=t,this.viewPort.panChange.next(t)},t.prototype.updateViewPortZoom=function(t){this.viewPort.zoom=t,this.viewPort.zoomChange.next(t)},t.prototype.updateViewPortWindow=function(t){this.viewPort.window=t,this.viewPort.windowChange.next(t)},t.prototype.updateCanvasWindow=function(t){this.canvas.window=t,this.canvas.windowChange.next(t)},t.prototype.updateCoordSet=function(t){this.controller.coordSet=t,this.controller.coordSetChange.next(t),this.viewPort.minZoom=t.minZoom,this.viewPort.maxZoom=t.maxZoom},t}();i.canvasIdCounter=0},"HsD/":function(t,e,n){"use strict";var o=n("/oeL"),r=n("Dqrr");n.n(r);n.d(e,"a",function(){return c});var i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},c=function(){function t(){this.itemSelectSubject=new r.Subject}return t.prototype.itemSelectObservable=function(){return this.itemSelectSubject},t.prototype.selectItem=function(t){this.itemSelectSubject.next(t)},t}();c=i([n.i(o.c)(),s("design:paramtypes",[])],c)},HzwN:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(){}return t}()},IEMT:function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("xPpy")),s=n("UMgL"),c=n("HzwN"),a=n("HsD/");n.d(e,"a",function(){return p});var u=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),l=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},f=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=function(t){function e(e,n,o){var r=t.call(this)||this;return r.vortexService=e,r.positionService=n,r.itemSelectService=o,r.modelSetKey=null,r.itemSelectServiceBridge=null,r.positionServiceBridge=null,r}return u(e,t),e.prototype.ngOnInit=function(){var t={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,o){return t[n]=o}),this.modelSetKey=t.modelSetKey;var e=t.vortexWsUrl;if(null!=e&&(r.VortexService.setVortexUrl(e),this.vortexService.reconnect()),null==this.modelSetKey||0==this.modelSetKey.length)throw alert("modelSetKey set is empty or null"),new Error("modelSetKey set is empty or null");this.oWebViewInterface=window.nsWebViewInterface,this.itemSelectServiceBridge=new s.a(this,this.itemSelectService,this.oWebViewInterface),this.positionServiceBridge=new i.a(this,this.positionService,this.oWebViewInterface)},e}(r.ComponentLifecycleEventEmitter);p=l([n.i(o.f)({selector:"ns-web-diagram",template:n("5wLy")}),f("design:paramtypes",["function"==typeof(d=void 0!==r.VortexService&&r.VortexService)&&d||Object,"function"==typeof(h=void 0!==c.a&&c.a)&&h||Object,"function"==typeof(y=void 0!==a.a&&a.a)&&y||Object])],p);var d,h,y},LjK0:function(t,e,n){"use strict";var o=n("EOrj");n.d(e,"a",function(){return o.a})},Mf0i:function(t,e,n){"use strict";var o=n("wuWp");n.d(e,"c",function(){return r}),n.d(e,"b",function(){return s}),n.d(e,"a",function(){return c});var r,i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){t[t.top=-1]="top",t[t.center=0]="center",t[t.bottom=1]="bottom"}(r||(r={}));var s;!function(t){t[t.left=-1]="left",t[t.center=0]="center",t[t.right=1]="right"}(s||(s={}));var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.textStyle=function(t){return t.fsl},e.color=function(t){return t.cl},e.verticalAlign=function(t){var e=t.va;return e==r.top?r.top:e==r.bottom?r.bottom:r.center},e.horizontalAlign=function(t){var e=t.ha;return e==s.left?s.left:e==s.right?s.right:s.center},e.rotation=function(t){return t.r},e.text=function(t){return t.te},e.height=function(t){return t.th},e.horizontalStretch=function(t){return t.hs},e.centerPointX=function(t){return t.g[0]},e.centerPointY=function(t){return t.g[1]},e}(o.a)},NRFc:function(t,e,n){"use strict";var o=n("/oeL"),r=n("BaDE"),i=n("p9o1");n.d(e,"a",function(){return u});var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(t){function e(){return t.call(this,null)||this}return s(e,t),e.prototype.create=function(t){return new i.a(t)},e.prototype.createActionStorage=function(){throw new Error("Action storage not implemented yet")},e}(r.TupleStorageFactoryService);u=c([n.i(o.c)(),a("design:paramtypes",[])],u)},OiVd:function(t,e,n){"use strict";var o=n("/oeL"),r=n("Dqrr"),i=(n.n(r),n("yMcj")),s=(n.n(i),n("vHfq")),c=n("AHZm"),a=n("PaR+");n.d(e,"a",function(){return h});var u=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),l=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},f=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},p=(n("Ad+1"),n.i(i.extend)({key:"clientGridWatchUpdateFromDevice"},s.a)),d=function(t){function e(e){return t.call(this,e,{})||this}return u(e,t),e.prototype.toOrderedJsonStr=function(){return this.name},e}(i.TupleSelector),h=function(){function t(){}return t}(),y=function(t){function e(e,n,o,a){var u=t.call(this)||this;return u.vortexService=e,u.vortexStatusService=n,u.tupleService=o,u.isReadySubject=new r.Subject,u.updatesObservable=new r.Subject,u.lifecycleEmitter=new i.ComponentLifecycleEventEmitter,u.lastWatchedGridKeys=[],u.gridCacheIndex=new c.a,u.cacheGridQueueChunks=[],u.storage=a.create(new i.TupleOfflineStorageNameService(s.b)),u.storage.open().then(function(){return u.loadGridCacheIndex()}).then(function(){return u.isReadySubject.next(!0)}).catch(function(t){return console.log("Failed to open grid cache db "+t)}),u.vortexService.createEndpointObservable(u.lifecycleEmitter,p).subscribe(function(t){return u.processGridsFromServer(t)}),u.vortexStatusService.isOnline.filter(function(t){return 1==t}).takeUntil(u.lifecycleEmitter.onDestroyEvent).subscribe(function(){return u.loadGrids({},u.lastWatchedGridKeys)}),u}return u(e,t),e.prototype.isReady=function(){return this.storage.isOpen()},e.prototype.isReadyObservable=function(){return this.isReadySubject},Object.defineProperty(e.prototype,"observable",{get:function(){return this.updatesObservable},enumerable:!0,configurable:!0}),e.prototype.cacheAll=function(){var t=this;this.vortexStatusService.snapshot.isOnline&&this.tupleService.tupleObserver.pollForTuples(new i.TupleSelector(c.a.tupleName,{})).then(function(e){if(e.length){var n=e[0],o=[],r=0,i={};for(var s in n.data)n.data.hasOwnProperty(s)&&(r+=1,null!=t.gridCacheIndex.data[s]?i[s]=t.gridCacheIndex.data[s]:i[s]=null,5==r&&(o.push(i),r=0,i={}));o.push(i),t.cacheGridQueueChunks=o,console.log("Cacheing "+t.cacheGridQueueChunks.length+" grid chunks"),t.cacheRequestNextChunk()}}).catch(function(t){return console.log("ERROR in cacheAll : "+t)})},e.prototype.cacheRequestNextChunk=function(){if(0!=this.cacheGridQueueChunks.length){console.log("Cacheing next grid chunk, "+this.cacheGridQueueChunks.length+" remaining");var t=this.cacheGridQueueChunks.pop(),e=new i.Payload(n.i(i.extend)({cacheAll:!0},p));e.tuples=[t],this.vortexService.sendPayload(e)}},e.prototype.watchGrids=function(t){this.lastWatchedGridKeys=t},e.prototype.loadGrids=function(t,e){var n=this;this.queryStorageGrids(e).then(function(e){for(var o=0,r=e;o<r.length;o++){var i=r[o];t[i.gridKey]=i.lastUpdate}n.sendWatchedGridsToServer(t)})},e.prototype.sendWatchedGridsToServer=function(t){if(this.vortexStatusService.snapshot.isOnline){var e=new i.Payload(p);e.tuples=[t],this.vortexService.sendPayload(e)}},e.prototype.processGridsFromServer=function(t){var e=this,n=t.tuples,o=new i.Payload({},n).toJsonDict(),r=(new i.Payload).fromJsonDict(o).tuples;this.updatesObservable.next(r),this.storeGridTuples(n).then(function(){!0===t.filt.cacheAll&&e.cacheRequestNextChunk()})},e.prototype.queryStorageGrids=function(t){var e=this;return this.storage.transaction(!1).then(function(n){for(var o=[],r=[],i=0,s=t;i<s.length;i++){var c=s[i];o.push(n.loadTuples(new d(c)).then(function(t){t.length&&(r.push(t[0]),e.updatesObservable.next(t))}))}return Promise.all(o).then(function(){return n.close().catch(function(t){return console.log("GridCache.queryStorageGrids commit:"+t)}),r})})},e.prototype.storeGridTuples=function(t){for(var e=this,n=[],o=0,r=t;o<r.length;o++){var i=r[o];n.push(i.gridKey)}return console.log("Caching grids "+n),this.storage.transaction(!0).then(function(n){for(var o=[],r=0,i=t;r<i.length;r++){var s=i[r];e.gridCacheIndex.data[s.gridKey]=s.lastUpdate,o.push(n.saveTuples(new d(s.gridKey),[s]))}return Promise.all(o).then(function(){return e.saveGridCacheIndex(n)}).then(function(){return n.close()}).catch(function(t){return console.log("GridCache.storeGridTuples: "+t)})})},e.prototype.loadGridCacheIndex=function(){var t=this;return this.storage.transaction(!1).then(function(e){return e.loadTuples(new i.TupleSelector(c.a.tupleName,{})).then(function(e){e.length&&(t.gridCacheIndex=e[0])})})},e.prototype.saveGridCacheIndex=function(t){return t.saveTuples(new i.TupleSelector(c.a.tupleName,{}),[this.gridCacheIndex]).catch(function(t){return console.log("GridCache.storeGridCacheIndex: "+t)})},e}(h);y=l([n.i(o.c)(),f("design:paramtypes",["function"==typeof(v=void 0!==i.VortexService&&i.VortexService)&&v||Object,"function"==typeof(_=void 0!==i.VortexStatusService&&i.VortexStatusService)&&_||Object,"function"==typeof(g=void 0!==a.a&&a.a)&&g||Object,"function"==typeof(b=void 0!==i.TupleStorageFactoryService&&i.TupleStorageFactoryService)&&b||Object])],y);var v,_,g,b},PS5I:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("fnfU")),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"SettingProperty",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"PaR+":function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("fnfU"));n.d(e,"a",function(){return a});var s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=function(){function t(t,e,n,o,s){var c=new r.TupleDataObservableNameService(i.d,i.a),a=new r.TupleOfflineStorageNameService(i.e),u=new r.TupleActionPushNameService(i.f,i.a),l=new r.TupleOfflineStorageService(o,a);this.tupleObserver=new r.TupleDataObserverService(e,n,s,c),this.tupleOfflineObserver=new r.TupleDataOfflineObserverService(e,n,s,c,l),this.tupleOfflineAction=new r.TupleActionPushOfflineService(u,e,n,t)}return t}();a=s([n.i(o.c)(),c("design:paramtypes",["function"==typeof(u=void 0!==r.TupleActionPushOfflineSingletonService&&r.TupleActionPushOfflineSingletonService)&&u||Object,"function"==typeof(l=void 0!==r.VortexService&&r.VortexService)&&l||Object,"function"==typeof(f=void 0!==r.VortexStatusService&&r.VortexStatusService)&&f||Object,"function"==typeof(p=void 0!==r.TupleStorageFactoryService&&r.TupleStorageFactoryService)&&p||Object,"function"==typeof(d=void 0!==o.d&&o.d)&&d||Object])],a);var u,l,f,p,d},QXLL:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"LocationIndexUpdateDateTuple",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},UMgL:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(t,e,n){this.lifeCycleEvents=t,this.service=e,this.iface=n,e.itemSelectObservable().takeUntil(t.onDestroyEvent).subscribe(function(t){console.log("WEB: Sending itemSelect event"),n.emit("itemSelected",t)})}return t}()},Un8m:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"DispLayer",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},V4he:function(t,e,n){"use strict";var o=n("tmW9"),r=n("yold");n.d(e,"a",function(){return s});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=function(t){function e(e){return t.call(this,e)||this}return i(e,t),e.prototype.draw=function(t,e,n){var o=r.a.fillColor(t),i=r.a.lineColor(t);o=o&&o.color?o:null,i=i&&i.color?i:null;var s=r.a.xRadius(t),c=r.a.yRadius(t),a=r.a.rotation(t)/180*Math.PI,u=r.a.startAngle(t),l=r.a.endAngle(t),f=r.a.lineWidth(t),p=c/s;e.save(),e.translate(r.a.centerPointX(t),r.a.centerPointY(t)),e.scale(1,p),e.rotate(a);var d=u/180*Math.PI,h=l/180*Math.PI;e.beginPath(),e.arc(0,0,s,d,h,!0),o&&(e.lineTo(0,0),e.fillStyle=o.color,e.fill()),i&&(e.strokeStyle=i.color,e.lineWidth=f/n,e.stroke()),e.restore()},e.prototype.drawSelected=function(t,e,n){},e.prototype.contains=function(t,e,n,o){return!1},e.prototype.withIn=function(t,e,n,o,r){return!1},e.prototype.handles=function(t){return[]},e.prototype.deltaMove=function(t,e,n){},e.prototype.area=function(t){return t.bounds.area()},e}(o.a)},ZQWO:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){var e=t.call(this,u.tupleName)||this;return e.CAP_BUTT="butt",e.CAP_ROUND="round",e.CAP_SQUARE="square",e.JOIN_BEVEL="bevel",e.JOIN_ROUND="round",e.JOIN_MITER="miter",e}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"DispLineStyle",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},b2ma:function(t,e,n){"use strict";var o=n("wuWp");n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(o.a)},cDNt:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("/oeL"),r=n("Qa4U"),i=n("5ckv");n("p5Ee").a.production&&n.i(o.a)(),n.i(r.a)().bootstrapModule(i.a)},cbTp:function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("cyHF")),s=n("FPdV"),c=n("Un8m"),a=n("1wOJ"),u=n("1c4N"),l=n("ZQWO"),f=n("PaR+");n.d(e,"a",function(){return h});var p=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},d=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},h=function(){function t(t){this.tupleService=t,this.modelSetKey="",this.loadedCounter={},this._lookupTargetCount=5,this._levelsById={},this._layersById={},this._colorsById={},this._textStyleById={},this._lineStyleById={},this._levelsByCoordSetIdOrderedByOrder={},this._layersOrderedByOrder=[],this.subscriptions=[],this._isReady=!1}return t.prototype.setModelSetKey=function(t){this.modelSetKey=t,this.initialLoad()},t.prototype.initialLoad=function(){var t=this,e=function(e,n,o){void 0===o&&(o=null),t.subscriptions.push(t.tupleService.tupleOfflineObserver.subscribeToTupleSelector(new r.TupleSelector(n,{modelSetKey:t.modelSetKey})).subscribe(function(n){if(n.length){t.loadedCounter[e]=!0,t[e]={};for(var r=0;r<n.length;r++){var i=n[r];t[e][i.id]=i}null!=o&&o()}}))};e("_levelsById",s.a.tupleName,function(){return t.createLevelsOrderedByOrder()}),e("_layersById",c.a.tupleName,function(){return t.createLayersOrderedByOrder()}),e("_colorsById",a.a.tupleName,function(){return t._validateColors()}),e("_textStyleById",u.a.tupleName),e("_lineStyleById",l.a.tupleName)},t.prototype.isReady=function(){if(this._isReady)return!0;var t=n.i(i.b)(this.loadedCounter,!0).length;return this._lookupTargetCount==t&&(this._isReady=!0,!0)},t.prototype.shutdown=function(){for(var t=0,e=this.subscriptions;t<e.length;t++){e[t].unsubscribe()}this.subscriptions=[]},t.prototype._validateColors=function(){for(var t=n.i(i.c)(this._colorsById),e=0;e<t.length;e++){var o=t[e];(function(t){if(""===t)return!1;if("inherit"===t)return!1;if("transparent"===t)return!1;var e=document.createElement("img");return e.style.color="rgb(0, 0, 0)",e.style.color=t,"rgb(0, 0, 0)"!==e.style.color||(e.style.color="rgb(255, 255, 255)",e.style.color=t,"rgb(255, 255, 255)"!==e.style.color)})(o.color)||(console.log("Color "+o.color+" is not a valid CSS color"),o.color="green")}},t.prototype.levelForId=function(t){return this._levelsById[t]},t.prototype.layerForId=function(t){return this._layersById[t]},t.prototype.colorForId=function(t){return this._colorsById[t]},t.prototype.textStyleForId=function(t){return this._textStyleById[t]},t.prototype.lineStyleForId=function(t){return this._lineStyleById[t]},t.prototype.layersOrderedByOrder=function(){return this._layersOrderedByOrder},t.prototype.levelsOrderedByOrder=function(t){var e=this._levelsByCoordSetIdOrderedByOrder[t];return null==e?[]:e},t.prototype.createLayersOrderedByOrder=function(){this._layersOrderedByOrder=n.i(i.c)(this._layersById).sort(function(t,e){return t.order-e.order})},t.prototype.createLevelsOrderedByOrder=function(){var t={};this._levelsByCoordSetIdOrderedByOrder=t;for(var e=n.i(i.c)(this._levelsById).sort(function(t,e){return t.order-e.order}),o=0;o<e.length;o++){var r=e[o];null==t[r.coordSetId]&&(t[r.coordSetId]=[]),t[r.coordSetId].push(r)}},t.prototype.linkDispLookups=function(t){return null!=t.le&&(t.lel=this._levelsById[t.le],null==t.lel)?null:null!=t.la&&(t.lal=this._layersById[t.la],null==t.lal)?null:null!=t.fs&&(t.fsl=this._textStyleById[t.fs],null==t.fsl)?null:null!=t.c&&(t.cl=this._colorsById[t.c],null==t.cl)?null:null!=t.lc&&(t.lcl=this._colorsById[t.lc],null==t.lcl)?null:null!=t.fc&&(t.fcl=this._colorsById[t.fc],null==t.fcl)?null:null!=t.ls&&(t.lsl=this._lineStyleById[t.ls],null==t.lsl)?null:t},t}();h=p([n.i(o.c)(),d("design:paramtypes",["function"==typeof(y=void 0!==f.a&&f.a)&&y||Object])],h);var y},cyHF:function(t,e,n){"use strict";function o(){var t=new Date;return t.toTimeString().split(" ")[0]+"."+t.getUTCMilliseconds()+": "}function r(t,e){void 0===e&&(e=!1);var n=[];for(var o in t)o.startsWith("_")&&!e||!t.hasOwnProperty(o)||"function"==typeof o||n.push(o);return n}function i(t){var e=[];for(var n in t)n.startsWith("_")||e.push(t[n]);return e}function s(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=!0;return e}function c(t,e){if(!t)throw console.trace(),new u(e)}function a(t){return 96*t/72}e.f=o,e.b=r,e.c=i,e.e=s,e.a=c,e.d=a;var u=function(){function t(t){this.message=t}return t.prototype.toString=function(){return"AssertException: "+this.message},t}()},fnfU:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"d",function(){return i}),n.d(e,"f",function(){return s}),n.d(e,"e",function(){return c}),n.d(e,"b",function(){return a}),n.d(e,"g",function(){return u});var o={plugin:"peek_plugin_diagram"},r="peek_plugin_diagram.",i="peek_plugin_diagram",s="peek_plugin_diagram",c="peek_plugin_diagram",a="peek_plugin_diagram_grids",u="peek_plugin_diagram_location_index"},g9Jp:function(t,e,n){"use strict";var o=n("LjK0"),r=n("rlar");n.n(r);n.d(e,"a",function(){return s});var i=function(){function t(){this.x=0,this.y=0}return t}(),s=function(){function t(t,e,n,o){this.config=t,this.model=e,this.dispDelegate=n,this.lifecycleEventEmitter=o,this.canvas=null,this.isValid=!1,this.drawEvent=new r.Subject,this._zoom=1,this._pan=new i}return t.prototype.invalidate=function(){this.isValid=!1},t.prototype.setCanvas=function(t){this.canvas=t,this._init()},t.prototype._init=function(){var t=this;setInterval(function(){return t.draw()},this.config.renderer.drawInterval),this.config.viewPort.zoomChange.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(e){e!=t._zoom&&t.zoom(e/t._zoom)}),this.config.viewPort.panChange.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(){return t.pan()}),this.config.canvas.windowChange.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(){return t.invalidate()}),this.config.renderer.invalidate.takeUntil(this.lifecycleEventEmitter.onDestroyEvent).subscribe(function(){return t.invalidate()})},t.prototype.currentViewArea=function(){var t={w:this.canvas.clientWidth/this._zoom,h:this.canvas.clientHeight/this._zoom};return new o.a(this._pan.x-t.w/2,this._pan.y-t.h/2,t.w,t.h)},t.prototype.zoom=function(t){this._zoom*t<this.config.viewPort.minZoom?t=this.config.viewPort.minZoom/this._zoom:this._zoom*t>this.config.viewPort.maxZoom&&(t=this.config.viewPort.maxZoom/this._zoom),this._zoom*=t,this.config.viewPort.zoom=this._zoom,this.config.updateViewPortWindow(this.currentViewArea()),this.invalidate()},t.prototype.pan=function(){var t=this.config.viewPort.pan;this._pan.x=t.x,this._pan.y=t.y,this.config.updateViewPortWindow(this.currentViewArea()),this.invalidate()},t.prototype.draw=function(){if(!this.isValid){this.isValid=!0;var t=this.canvas.getContext("2d"),e=this.model.viewableDisps(),n=this.model.selectedDisps(),o=this.canvas.width/this._zoom,r=this.canvas.height/this._zoom;t.save(),t.translate(this.canvas.width/2,this.canvas.height/2),t.scale(this._zoom,this._zoom),t.translate(-this._pan.x,-this._pan.y),t.fillStyle=this.config.renderer.backgroundColor,t.fillRect(this._pan.x-o,this._pan.y-r,2*o,2*r),this._drawGrid(t);for(var i=0;i<e.length;i++){var s=e[i];this.dispDelegate.draw(s,t,this._zoom,this._pan)}for(var i=0;i<n.length;i++){var s=n[i];this.dispDelegate.drawSelected(s,t,this._zoom,this._pan)}this.drawEvent.next(t),t.restore()}},t.prototype._drawGrid=function(t){function e(t){return parseInt(t)}if(this.config.renderer.grid.show){var n=this.config.viewPort.window,o=this.config.viewPort.zoom,r=1/o,i=this.config.controller.coordSet.gridSizeForZoom(o),s=n.x,c=n.y,a=n.x+n.w,u=n.y+n.h,l=e(s/i.xGrid),f=e(a/i.xGrid)+1,p=e(c/i.yGrid),d=e(u/i.yGrid)+1;t.lineWidth=this.config.renderer.grid.lineWidth/this._zoom,t.strokeStyle=this.config.renderer.grid.color,t.fillStyle=this.config.renderer.grid.color,t.textAlign="start",t.textBaseline="top",t.font=this.config.renderer.grid.font;for(var h=l;h<f;h++)t.beginPath(),t.moveTo(h*i.xGrid,c),t.lineTo(h*i.xGrid,u),t.stroke();for(var y=p;y<d;y++)t.beginPath(),t.moveTo(s,y*i.yGrid),t.lineTo(a,y*i.yGrid),t.stroke();for(var h=l;h<f;h++)for(var y=p;y<d;y++){var v=h.toString()+"x"+y.toString();t.save(),t.translate(h*i.xGrid+15,y*i.yGrid+15),t.scale(r,r),t.fillText(v,0,0),t.restore()}}},t.prototype.canvasInnerBounds=function(){var t=this.canvas;return new o.a(0,0,t.width,t.height)},t}()},jGMM:function(t,e,n){"use strict";var o=n("tmW9");n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.draw=function(t,e,n,o){},e.prototype.drawSelected=function(t,e,n,o){var r=this.config.renderer.selection,i=t.bounds,s=(r.width+r.lineGap)/n,c=2*s,a=i.x-s,u=i.y-s,l=i.w+c,f=i.h+c;e.dashedRect(a,u,l,f,r.dashLen/n),e.strokeStyle=r.color,e.lineWidth=r.width/n,e.stroke()},e.prototype.contains=function(t,e,n,o){return t.bounds.contains(e,n,o)},e.prototype.withIn=function(t,e,n,o,r){return t.bounds.withIn(e,n,o,r)},e.prototype.handles=function(t){return[]},e.prototype.deltaMove=function(t,e,n){},e.prototype.area=function(t){return t.bounds.area()},e}(o.a)},lt2r:function(t,e,n){e=t.exports=n("rP7Y")(!1),e.push([t.i,".canvas-status-bar{z-index:3;position:absolute;margin:0 auto;color:grey;right:10px}canvas{width:100%;z-index:1}",""]),t.exports=t.exports.toString()},n7du:function(t,e){function n(t){throw new Error("Cannot find module '"+t+"'.")}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="n7du"},nHid:function(t,e){t.exports='<div>\n    <p class="canvas-status-bar ">{{mouseInfo()}}</p>\n\n    <canvas #canvas class="canvas " >\n        Sorry, your browser doesn\'t support the &lt;canvas&gt; element.\n    </canvas>\n</div>\n'},nHty:function(t,e,n){"use strict";var o=n("tmW9"),r=n("Mf0i"),i=n("cyHF");n.d(e,"a",function(){return c});var s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.prototype.draw=function(t,e,o,s){var c=r.a.rotation(t)/180*Math.PI,a=r.a.textStyle(t),u=r.a.color(t);u=u&&u.color?u:null;var l=r.a.horizontalStretch(t),f=r.a.height(t),p=a.fontSize*a.scaleFactor;null!=f&&(p=f);var d=p+"px "+a.fontName+" "+(a.fontStyle||""),h=n.i(i.d)(p),y=null,v=r.a.horizontalAlign(t);v==r.b.left?y="start":v==r.b.center?y="center":v==r.b.right&&(y="end");var _=null,g=r.a.verticalAlign(t);if(g==r.c.top?_="top":g==r.c.center?_="middle":g==r.c.bottom&&(_="bottom"),e.save(),e.translate(r.a.centerPointX(t),r.a.centerPointY(t)),e.rotate(c),e.textAlign=y,e.textBaseline=_,e.font=d,!a.scalable){var b=1/o;e.scale(b,b)}1!=l&&e.scale(l,1);for(var m=r.a.text(t).split("\n"),S=0;S<m.length;++S){var w=m[S],O=h*S;u&&(e.fillStyle=u.color,e.fillText(w,0,O))}e.restore()},e.prototype.drawSelected=function(t,e,n,o){},e.prototype.contains=function(t,e,n,o){return!1},e.prototype.withIn=function(t,e,n,o,r){return!1},e.prototype.handles=function(t){return[]},e.prototype.deltaMove=function(t,e,n){},e.prototype.area=function(t){return 0},e}(o.a)},p5Ee:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o={production:!0}},p9o1:function(t,e,n){"use strict";var o=n("yMcj");n.n(o);n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(n){var o=t.call(this,n)||this;return e.initHandler(),o}return r(e,t),e.initHandler=function(){if(!e.isInitialised){e.isInitialised=!0;window.nsWebViewInterface.on("tupleStoragePromiseFinished",function(t){var n=(new o.Payload).fromJsonDict(t).tuples;console.log("WEB: Received tupleStoragePromiseResolved event"),e.promsById[n.promId][n.action](n.result),delete e.promsById[n.promId]})}},e.prototype.open=function(){return Promise.resolve()},e.prototype.isOpen=function(){return!0},e.prototype.close=function(){},e.prototype.transaction=function(t){return Promise.resolve(new s(t))},e}(o.TupleStorageServiceABC);i.promsById={},i.nextPromiseId=1,i.isInitialised=!1;var s=function(){function t(t){this.forWrite=t,this.iface=window.nsWebViewInterface}return t.prototype.loadTuples=function(t){return this.loadTuplesEncoded(t).then(function(t){return null==t?[]:o.Payload.fromVortexMsg(t).then(function(t){return t.tuples})})},t.prototype.loadTuplesEncoded=function(t){var e=this,n=i.nextPromiseId++;return new Promise(function(r,s){i.promsById[n]={resolve:r,reject:s};var c={promId:n,tupleSelector:t},a=new o.Payload({},c).toJsonDict();console.log("WEB: Sending loadTuplesEncoded event"),e.iface.emit("loadTuplesEncoded",a)})},t.prototype.saveTuples=function(t,e){var n=this;return new o.Payload({},e).toVortexMsg().then(function(e){return n.saveTuplesEncoded(t,e)})},t.prototype.saveTuplesEncoded=function(t,e){var n=this,r=i.nextPromiseId++;return new Promise(function(s,c){i.promsById[r]={resolve:s,reject:c};var a={promId:r,tupleSelector:t,vortexMsg:e},u=new o.Payload({},a).toJsonDict();console.log("WEB: Sending saveTuplesEncoded event"),n.iface.emit("saveTuplesEncoded",u)})},t.prototype.close=function(){return Promise.resolve()},t}()},pXRQ:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("vHfq"));n.d(e,"a",function(){return a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e.fromLocationJson=function(t){var e=new u;return e.coordSetId=t[0],e.dispId=t[1],e.x=t[2],e.y=t[3],e},e}(o.Tuple);a.tupleName=r.c+"DispKeyLocationTuple",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},pibO:function(t,e,n){"use strict";var o=n("wuWp");n.d(e,"a",function(){return s});var r,i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();!function(t){t[t.fillTopToBottom=0]="fillTopToBottom",t[t.fillBottomToTop=1]="fillBottomToTop",t[t.fillRightToLeft=2]="fillRightToLeft",t[t.fillLeftToRight=3]="fillLeftToRight"}(r||(r={}));var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.fillColor=function(t){return t.fcl},e.lineColor=function(t){return t.lcl},e.lineStyle=function(t){return t.lsl},e.cornerRadius=function(t){return t.cr},e.lineWidth=function(t){return t.w},e.geom=function(t){return t.g},e.fillDirection=function(t){var e=t.fd;return e==r.fillBottomToTop?r.fillBottomToTop:e==r.fillRightToLeft?r.fillRightToLeft:e==r.fillLeftToRight?r.fillLeftToRight:r.fillTopToBottom},e.fillPercent=function(t){return t.fp},e}(o.a)},qhij:function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("OiVd")),s=n("Dqrr");n.n(s);n.d(e,"a",function(){return l});var c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},u=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=f=function(t){function e(){return t.call(this)||this}return c(e,t),e.initHandler=function(){f.isInitialised||(f.isInitialised=!0,f.iface=window.nsWebViewInterface,f.iface.on("GridLoaderBridge_observable",function(t){var e=(new r.Payload).fromJsonDict(t).tuples;console.log("WEB: Received GridLoaderBridge_observable event"),f.updateSubject.next(e)}),f.iface.on("GridLoaderBridge_isReadyObservable",function(t){console.log("WEB: Received GridLoaderBridge_isReadyObservable event"),f.isReadyVal=t,f.readySubject.next(t)}),f.iface.emit("GridLoaderBridge_start","nothing"))},Object.defineProperty(e.prototype,"observable",{get:function(){return f.updateSubject},enumerable:!0,configurable:!0}),e.prototype.isReady=function(){return f.initHandler(),f.isReadyVal},e.prototype.isReadyObservable=function(){return f.readySubject},e.prototype.cacheAll=function(){throw new Error("Not Implemented")},e.prototype.loadGrids=function(t,e){var n={currentGridUpdateTimes:t,gridKeys:e},o=new r.Payload({},n).toJsonDict();console.log("WEB: Sending GridLoaderBridge_loadGrids event"),f.iface.emit("GridLoaderBridge_loadGrids",o)},e.prototype.watchGrids=function(t){var e=new r.Payload({},t).toJsonDict();console.log("WEB: Sending GridLoaderBridge_watchGrids event"),f.iface.emit("GridLoaderBridge_watchGrids",e)},e}(i.a);l.updateSubject=new s.Subject,l.readySubject=new s.Subject,l.isReadyVal=!1,l.isInitialised=!1,l=f=a([n.i(o.c)(),u("design:paramtypes",[])],l);var f},sZSy:function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("1djn")),s=n("PaR+");n.d(e,"a",function(){return u});var c=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=function(){function t(t){this.tupleService=t,this.modelSetKey="",this._coordSetByKey={},this._coordSetById={},this.subscriptions=[],this._isReady=!1,this.initialLoad()}return t.prototype.initialLoad=function(){var t=this;this.subscriptions.push(this.tupleService.tupleOfflineObserver.subscribeToTupleSelector(new r.TupleSelector(i.a.tupleName,{})).subscribe(function(e){t._coordSetByKey={};for(var n=0,o=e;n<o.length;n++){var r=o[n];t._coordSetByKey[r.key]=r,t._coordSetById[r.id]=r}}))},t.prototype.shutdown=function(){for(var t=0,e=this.subscriptions;t<e.length;t++){e[t].unsubscribe()}this.subscriptions=[]},t.prototype.isReady=function(){if(this._isReady)return!0;var t=0;for(var e in this._coordSetByKey)t++;return 0!=t&&(this._isReady=!0,!0)},t.prototype.coordSetForKey=function(t){return this._coordSetByKey[t]},t.prototype.coordSetForId=function(t){return this._coordSetById[t]},t}();u=c([n.i(o.c)(),a("design:paramtypes",["function"==typeof(l=void 0!==s.a&&s.a)&&l||Object])],u);var l},tRBE:function(t,e,n){"use strict";var o=n("/oeL"),r=n("cbTp"),i=n("2pCw"),s=n("OiVd"),c=n("Dqrr"),a=(n.n(c),n("yMcj")),u=(n.n(a),n("cyHF")),l=n("ge1L");n.n(l);n.d(e,"a",function(){return y});var f=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},p=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},d=n("Ad+1"),h=function(){function t(){this.cache={}}return t.prototype.put=function(t){this.cache[t.gridKey]=t},t.prototype.get=function(t){return this.has(t)?this.cache[t]:null},t.prototype.del=function(t){delete this.cache[t]},t.prototype.has=function(t){return this.cache.hasOwnProperty(t)},t}(),y=function(){function t(t,e){var n=this;this.lookupCache=t,this.gridLoader=e,this.updatesObservable=new c.Subject,this.cacheQueue=[],this.MAX_CACHE=50,this.lifecycleEmitter=new a.ComponentLifecycleEventEmitter,this.gridLoader.observable.takeUntil(this.lifecycleEmitter.onDestroyEvent).subscribe(function(t){return n.processGridUpdates(t)})}return t.prototype.isReady=function(){return this.gridLoader.isReady()},Object.defineProperty(t.prototype,"observable",{get:function(){return this.updatesObservable},enumerable:!0,configurable:!0}),t.prototype.updateWatchedGrids=function(t){this.gridLoader.watchGrids(t);for(var e=this.rotateCache(t),o=0,r=n.i(u.c)(e);o<r.length;o++){var i=r[o];this.updatesObservable.next(i)}for(var s=[],c={},a=0,l=t;a<l.length;a++){var f=l[a],p=e.get(f);c[f]=null==p?null:p.lastUpdate,null==p&&s.push(f)}this.gridLoader.loadGrids(c,s)},t.prototype.rotateCache=function(t){for(var e=new h,n=0,o=t;n<o.length;n++)for(var r=o[n],i=0,s=this.cacheQueue;i<s.length;i++){var c=s[i],a=!1;if(!a){var u=c.get(r);null!=u&&(e[r]=u,a=!0)}c.del(r)}for(this.cacheQueue.unshift(e);this.cacheQueue.length>this.MAX_CACHE;)this.cacheQueue.pop();return e},t.prototype.processGridUpdates=function(t){for(var e=this.cacheQueue[0],n=0,o=t;n<o.length;n++){var r=o[n];try{r.dispJsonStr=d.inflate(r.blobData,{to:"string"})}catch(t){console.log(t.toString())}r.blobData=null;var s=e[r.gridKey];if(null!=s){var c=l(s.lastUpdate);if(l(r.lastUpdate).isBefore(c))continue}var a=new i.a(r,this.lookupCache);e.put(a),this.updatesObservable.next(a)}},t}();y=f([n.i(o.c)(),p("design:paramtypes",["function"==typeof(v=void 0!==r.a&&r.a)&&v||Object,"function"==typeof(_=void 0!==s.a&&s.a)&&_||Object])],y);var v,_},tmW9:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(t){this.config=t}return t}()},tqqM:function(t,e,n){"use strict";var o=n("/oeL"),r=n("yMcj"),i=(n.n(r),n("fnfU"));n.d(e,"a",function(){return a});var s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=function(){function t(t,e,n,o){var s=new r.TupleDataObservableNameService(i.d,i.a),c=new r.TupleOfflineStorageNameService(i.e),a=(new r.TupleActionPushNameService(i.f,i.a),new r.TupleOfflineStorageService(n,c));this.tupleOfflineObserver=new r.TupleDataOfflineObserverService(t,e,o,s,a)}return Object.defineProperty(t.prototype,"tupleOfflineAction",{get:function(){throw new Error("tupleOfflineAction is not implemented")},enumerable:!0,configurable:!0}),t}();a=s([n.i(o.c)(),c("design:paramtypes",["function"==typeof(u=void 0!==r.VortexService&&r.VortexService)&&u||Object,"function"==typeof(l=void 0!==r.VortexStatusService&&r.VortexStatusService)&&l||Object,"function"==typeof(f=void 0!==r.TupleStorageFactoryService&&r.TupleStorageFactoryService)&&f||Object,"function"==typeof(p=void 0!==o.d&&o.d)&&p||Object])],a);var u,l,f,p},u03e:function(t,e,n){"use strict";var o=n("yMcj"),r=(n.n(o),n("fnfU")),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,s=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(r=t[c])&&(s=(i<3?r(s):i>3?r(e,n,s):r(e,n))||s);return i>3&&s&&Object.defineProperty(e,n,s),s},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},a=u=function(t){function e(){return t.call(this,u.tupleName)||this}return i(e,t),e}(o.Tuple);a.tupleName=r.c+"DiagramLoaderStatusTuple",a=u=s([o.addTupleType,c("design:paramtypes",[])],a);var u},"uI+l":function(t,e){var n=CanvasRenderingContext2D.prototype;n.roundRect=function(t,e,n,o,r){var i=t+n,s=e+o,c=Math.PI/180;i-t-2*r<0&&(r=(i-t)/2),s-e-2*r<0&&(r=(s-e)/2),this.beginPath(),this.moveTo(t+r,e),this.lineTo(i-r,e),this.arc(i-r,e+r,r,270*c,360*c,!1),this.lineTo(i,s-r),this.arc(i-r,s-r,r,0*c,90*c,!1),this.lineTo(t+r,s),this.arc(t+r,s-r,r,90*c,180*c,!1),this.lineTo(t,e+r),this.arc(t+r,e+r,r,180*c,270*c,!1),this.closePath()},n.dashedLine=function(t,e,n,o,r){this.moveTo(t,e);for(var i=n-t,s=o-e,c=Math.floor(Math.sqrt(i*i+s*s)/r),a=i/c,u=s/c,l=0;l++<c;)t+=a,e+=u,this[l%2==0?"moveTo":"lineTo"](t,e);this[l%2==0?"moveTo":"lineTo"](n,o)},n.dashedRect=function(t,e,n,o,r){if(0==r)this.beginPath(),this.rect(t,e,n,o),this.closePath();else{this.beginPath();var i=t+n,s=e+o;this.dashedLine(t,e,i,e,r),this.dashedLine(i,e,i,s,r),this.dashedLine(i,s,t,s,r),this.dashedLine(t,s,t,e,r),this.closePath()}}},vHfq:function(t,e,n){"use strict";var o=n("fnfU");n.d(e,"a",function(){return o.a}),n.d(e,"b",function(){return o.b}),n.d(e,"c",function(){return o.c}),n.d(e,"d",function(){return o.g});n("u03e"),n("PS5I")},wuWp:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(){}return t.id=function(t){return t.id},t.level=function(t){return t.lel},t.layer=function(t){return t.lal},t.isSelectable=function(t){return t.s},t.key=function(t){return t.k},t.data=function(t){return null==t.d?{}:JSON.parse(t.d)},t}()},xPpy:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(t,e,n){var o=this;this.lifeCycleEvents=t,this.service=e,this.iface=n;var r=e;this.iface.on("positionSubject",function(t){console.log("WEB: Received positionSubject event"),e.position(t.coordSetKey,t.x,t.y,t.zoom)}),this.iface.on("positionByCoordSetObservable",function(t){console.log("WEB: Received positionByCoordSetObservable event"),e.positionByCoordSet(t)}),t.onDestroyEvent.subscribe(function(){o.iface.off("positionSubject"),o.iface.off("positionByCoordSetObservable")}),r.isReadyObservable().takeUntil(t.onDestroyEvent).subscribe(function(t){console.log("WEB: Sending isReadySubject "+t),n.emit("isReadySubject",t)}),r.positionUpdatedObservable().takeUntil(t.onDestroyEvent).subscribe(function(t){console.log("WEB: Sending positionUpdated"),n.emit("positionUpdated",t)}),r.titleUpdatedObservable().takeUntil(t.onDestroyEvent).subscribe(function(t){console.log("WEB: Sending titleUpdatedSubject "+t),n.emit("titleUpdatedSubject",t)})}return t}()},yold:function(t,e,n){"use strict";var o=n("wuWp");n.d(e,"a",function(){return i});var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.fillColor=function(t){return t.fcl},e.lineColor=function(t){return t.lcl},e.lineStyle=function(t){return t.lsl},e.lineWidth=function(t){return t.w},e.centerPointX=function(t){return t.g[0]},e.centerPointY=function(t){return t.g[1]},e.xRadius=function(t){return t.xr},e.yRadius=function(t){return t.yr},e.rotation=function(t){return t.r},e.startAngle=function(t){return t.sa},e.endAngle=function(t){return t.ea},e}(o.a)},zSxQ:function(t,e){t.exports='<button class="btn">tb1</button>\n<button class="btn">tb2</button>'}},[0]);